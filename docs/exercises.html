<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>exercises.knit</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Textbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./textbook.html">Theory</a>
    </li>
    <li>
      <a href="./exercises.html">Exercises</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="workbook-files" class="section level1">
<h1>Workbook files</h1>
<p>The hyperlink below will take you to a github repository. You can
then download each file individually from there.</p>
<p><a
href="https://github.com/hschoonwinkel/vbaccounting/tree/main/excel">Click
here to access files on Gitgub</a>.</p>
</div>
<div id="instructions" class="section level1">
<h1>Instructions</h1>
<div id="chapter-1-exercises" class="section level3">
<h3>Chapter 1 Exercises</h3>
<p>Use the workbook provided and complete the form provided by entering
your details in the provided blue areas, using VBA. Code your questions
to all the below questions within one macro in the VB Editor. Rerun your
macro after completing each question, to make sure your macro works
correctly. Refer to the cell address by using “range”. Thereafter,
reperform all the below questions in a new macro, by referring to the
cell addresses by using “cells”.</p>
<p>Q1: Enter your name in cell B1. Q2: Enter your surname in cell B2.
Q3: Enter your year of birth in cell B3. Q4: Enter your age in cell B4.
Q5: Calculate the current year in cell B6, by adding your year of birth
(B3) to your age (B4). Q6: Assign all cells in the range C9:E11 equal to
the value of 420.</p>
</div>
<div id="chapter-2-exercises" class="section level3">
<h3>Chapter 2 Exercises</h3>
<p>Use the workbook provided and complete the form provided by entering
your details in the provided blue areas, using VBA within one macro.
Rerun the macro after each question to test accuracy.</p>
<p>Q1: Declare a variable named ‘nameSurname’. Assign it a value equal
to your name and surname. Set the value of cell B1 equal to the value of
that variable.</p>
<p>Q2: Declare a variable named ‘yearBirth’. Assign it a value equal to
your year of birth. Set the value of cell B2 equal to the value of that
variable.</p>
<p>Q3: Declare a variable named ‘age’. Assign it a value equal to the
value as found in cell F1. Set the value of cell B3 equal to the value
of that variable.</p>
<p>Q4: Create a macro button for your macro created thus far.</p>
<p>Q5: Change the value in cell F1 to your actual age, using manual
traditional Excel (no VBA).</p>
<p>Q6: Rerun the macro created in Q3, by pressing the button created in
Q4. Did the value in cell B3 change to your actual age? If not, you did
not do Q3 correctly. Make sure you did not “hard code” the age into your
formula by expressing it directly, but rather expressed that the age
should equal whatever value is found in cell F1.</p>
<p>Q7: Declare a variable named ‘idNumber’. Assign it a value equal to
your ID number. Set the value of cell B4 equal to the value that
variable.</p>
<p>Q8: Declare a variable named ‘currentYear’. Assign it a value equal
to the ‘yearBirth’ variable plus the ‘age’ variable. Set the value of
cell B6 equal to the value of the ‘cuurentYear’ variable.</p>
<p>Q9: Increment the ‘age’ variable with 5. Rerun the macro. Nothing
will change on the sheet. The answer obtained in Q8 for cell B6 would
not change, despite referencing the ‘age’ variable, as we only changed
the value of the variable after that line of code.</p>
<p>Q10: Set the value of ‘currentYear’ once again equal to the
‘yearBirth’ variable plus the ‘age’ variable again. Set the value of
cell B6 equal to the value of that variable. Running the macro again
should now change the value in cell B6 by incrementing it with 5, as the
‘age’ variable, which is used to calculate the ‘currentYear’ value, has
incremented with 5 in the previous line of code.</p>
<p>Q11: Declare a variable named ‘i’. Set it equal to the value as found
in cell B10. Then declare a variable named ‘j’ and set it equal to the
value as found in cell B11. Then set the value of the cell with the row
of i and column j equal to the text value “Federer” (in the VB
Editor).</p>
<p>Q12: Change the values in cells B10 and B11 to any numbers of your
liking, using manual traditional Excel (no VBA).</p>
<p>Q13: Rerun the macro in which your code for Q11 was placed. In which
cell did the word “Federer” now appear? Did the word “Federer” still
appear in cell D17 as well, or did the contents in cell D17 disappear?
Why/why not?</p>
</div>
<div id="chapter-3-exercises" class="section level3">
<h3>Chapter 3 Exercises</h3>
<p>Use the workbook provided and code your questions to all the below
questions within one macro in the VB Editor. Rerun your macro after
completing each question, to make sure your macro works correctly.</p>
<p>Q1: Enter a body temperature in cell C1, using manual traditional
Excel (no VBA). Using VBA, write code that would display the message
“Covid warning” in cell C2 if the temperature entered in cell C1 is
above 37,5 degrees Celsius.</p>
<p>Q2: Enter an age in cell C4, using manual traditional Excel (no VBA).
Using VBA, write code that would display the message “You may enter” in
cell C5 if the age entered in cell C4 is 18 or above. Otherwise, the
message “You may not enter” should appear.</p>
<p>Q3: Enter a cricket batting average (usually between 10 and 50) in
cell C17 and a batting strike rate (usually between 70 and 120) in cell
C8, using manual traditional Excel (no VBA). Batsmen are picked for the
cricket team if both of the following conditions are met: their batting
average should be 40 or higher, and their batting strike rate should be
80 or higher. Write Using VBA, write code that would display the message
“Yes” in cell C9 if the batsmen should be picked for the team. The
message “No” should appear if the batsmen should not be picked for the
team.</p>
<p>Q4: Enter a cricket bowling average (usually between 20 and 40) in
cell C11 and a bowling strike rate (usually between 40 and 60) in cell
C12, using manual traditional Excel (no VBA). Bowlers are picked for the
cricket team if either of the following conditions are met: their
bowling average should be 30 or lower, or their bowling strike rate
should be 50 or lower. Write Using VBA, write code that would display
the message “Yes” in cell C13 if the bowler should be picked for the
team. The message “No” should appear if the bowler should not be picked
for the team.</p>
<p>You can change your values in the blue input cells and rerun your
macro to make sure that your macro correctly caters for all possible
scenarios.</p>
</div>
<div id="chapter-4-exercises" class="section level3">
<h3>Chapter 4 Exercises</h3>
<p>Use the workbook provided and code your questions to all the below
questions within one macro in the VB Editor. Rerun your macro after
completing each question, to make sure your macro works correctly.</p>
<p>Q1: Copy the contents of cell A4 and paste it to cell C6. Q2: Copy
the contents of the range A12:B15 and paste it to E15:G18</p>
</div>
<div id="chapter-5-exercises" class="section level3">
<h3>Chapter 5 Exercises</h3>
<p>Use the workbook provided and declare a variable named “lastrow” and
assign it a value equal to the lastrow of the database given. Assign
cell G1 equal to the value of the ‘lastrow’ variable.</p>
</div>
<div id="chapter-6-exercises" class="section level3">
<h3>Chapter 6 Exercises</h3>
<p>You are provided with a dataset containing a list of individuals,
containing their name, year of birth and age. A button, for which no
macro has yet been written, is also provided. When the button is
pressed, a message should appear, asking the user for his/her name.
After the user inputted a name and clicked OK, a new message should
appear, asking the user for his/her year of birth. After the user
inputted a number and clicked OK, the compiler should add an entry to
the dataset (tip: determine the last row as done in Chapter 5, and add
one to that variable to determine in which row the entry should be
added), containing the name, year of birth and the age in 2022 (which it
should calculate). A message should then appear, informing the user that
the entry has been successfully added.</p>
</div>
<div id="chapter-7-exercises" class="section level3">
<h3>Chapter 7 Exercises</h3>
</div>
<div id="part-i" class="section level3">
<h3>Part I</h3>
<p>Your are presented with 2 worksheets: one sheet containing players
from Manchester City Football Club, and the other sheet containing
players from Manchester United Football Club. In the third worksheet,
titled “All Manchester”, you want to combine these two pool of players
into one database. Using VBA, create code that would execute this.</p>
</div>
<div id="part-ii" class="section level3">
<h3>Part II</h3>
<p>Your are presented with 2 workbooks: one workbook containing item
sales for July, and the other workbook containing item sales for August.
In the third workbook, titled “Combined”, you want to combine these two
months of sales into one database. Two macros should be written inside
the Combined workbook. The first macro should import the separate July
and August workbooks as separate worksheets within the Combined workbook
(use the template code provided in Chapter 7). The second macro should
then combine these two months into one database.</p>
</div>
<div id="chapter-8-exercises" class="section level3">
<h3>Chapter 8 Exercises</h3>
</div>
<div id="part-i---merge-worksheets" class="section level3">
<h3>Part I - Merge Worksheets</h3>
<p>You are presented with a workbook containing sales made for each
colour product in separate sheets. Your task is to merge all these
separate datasets into one dataset in the worksheet titled ‘Merged’.</p>
<p>Tips: Loop through all colour worksheets (start at sheet 2) and for
each each sheet, determine the last row to determine the range to be
copied, and determine where to start pasting in the ‘Merged sheet’ (row
after its last row) and paste it over.</p>
</div>
<div id="part-ii---merge-workbooks" class="section level3">
<h3>Part II - Merge Workbooks</h3>
<p>Your are presented with separate workbooks containing sales made for
each colour product. Your tasks are to:</p>
<ol style="list-style-type: decimal">
<li>Import every workbook into one single workbook as separate
worksheets AND rename each worksheet to the colour of that dataset.</li>
<li>Merge all these separate datasets into one dataset.</li>
</ol>
</div>
<div id="part-iii---reverse-merge-extract" class="section level3">
<h3>Part III - Reverse Merge (Extract)</h3>
<p>Your are presented with a database containing sales made for all
colour products. Your task is to create a separate dataset for all
respective colours in separate worksheets (basically the reverse of task
2). After the macro has been executed, a message should appear informing
the user that the macro ran successfully. Allocate this macro to the
button provided.</p>
<p>Tips: You will have a loop within a loop. The outer loop will loop
through each entry in the dataset in the ‘Merged’ sheet, while the inner
loop will loop through each worksheet. First, loop through the entries
in the dataset. For each entry, we need to find the sheet who’s name
matches the colour of that product. This is done by looping through all
the colour worksheets, then if the name of the worksheet (in inner loop)
equals the colour of our entry (in the outer loop), then we need to
determine where to start pasting in that sheet, and paste the entry
there.</p>
</div>
<div id="part-iv---semi-structured-dataset" class="section level3">
<h3>Part IV - Semi Structured Dataset</h3>
<p>Your are presented with a database containing sales made for all
colour products. This dataset is semi-structured. Your task is to
transform this dataset into a structured relational dataset in the other
worksheet provided.</p>
<p>Tips: Create a variable that would store the colour name. Loop
through each row in the semi-structured dataset. If the value of the
cell in column A is “Colour:” then store the value next to it as the
value for the colour variable. If the value of the cell in column A is
“Date” then do nothing (just have no code in that if section). Otherwise
(if none of the previous two conditions are met), the date, amount and
colour of that entry should be pasted to the structured dataset. Note:
do not use copy and paste. Rather first assign column A of structured
dataset equal to the value as found in column A of the semi-structured
dataset, then assign column B of the structured dataset equal to
variable of colour at that stage, then assign column C of the structured
dataset equal to the value as found in column B of the semi-structured
dataset.</p>
</div>
<div id="part-v---balance-updates" class="section level3">
<h3>Part V - Balance Updates</h3>
<p>You are required to build a system that would enable a user to easily
add an invoice or payment to a customer account, and update its
outstanding balance accordingly.</p>
<p>You are presented with a workbook containing:</p>
<ul>
<li>A worksheet titled ‘Buttons’, containing two buttons</li>
<li>A worksheet for every customer, titled by its customer number.</li>
</ul>
<p>When clicking on the ‘Add invoice’ or ‘Add Payment’ button, a message
should appear asking the user to input the customer number to whom this
invoice/payment should be levied. After the user inputted the number and
clicked ‘OK’, a message should then appear asking the user to input the
invoice/payment amount. After the user inputted the amount and clicked
‘OK’, an entry should be added to the applicable customer account in
that worksheet, containing the date of the document (hint: use ‘today()’
function), the document type (pending on which button clicked), the
amount (if it is a payment, it should be negative), and the updated
balance of the customer. A message should then appear indicating to the
user that the transaction was added successfully.</p>
<p>Create two separate macros for each button respectively.</p>
</div>
<div id="chapter-9-exercises" class="section level3">
<h3>Chapter 9 Exercises</h3>
<p>You are presented with a sheet containing sales of red, blue, green
and yellow items respectively. The goal is to create an extract of each
colour to their own respective datasets. Macros have already been
written and allocated to buttons that will enable this. There are 3
methods that this exercise can be done, for which 3 separate macros were
created:</p>
<ol style="list-style-type: decimal">
<li><p>Copy and Paste: For each row, determine if it is a certain
colour, and if so, copy that region (line-item columns) and paste it
under the applicable colour heading.</p></li>
<li><p>Assign values: For each row, determine if it is a certain colour,
and if so, assign the cells of the first empty line under the colour
section equal to the values as found in that row in the complete
dataset.</p></li>
<li><p>Arrays: Assign the complete dataset to an array. Then create new
arrays for each colour. Loop through all elements of the total array,
and if the colour of that element is a certain colour, assign the
elements of that colour’s array equal to those values in the total
array. Then finally, assign the region of that colours extract equal to
the colours’ array.</p></li>
</ol>
<p>Inspect the syntax of the array method and obtain an understanding of
its workings.</p>
<p>The goal of this exercise is to indicate the difference in time it
takes to execute each macro (the extracts should be deleted each time
before executing the next macro, as they all result in the same thing).
You will notice that the first method could take up to a minute, while
the second method is a bit faster, and the third method (using arrays)
takes less than one second!</p>
</div>
<div id="chapter-10-exercises" class="section level3">
<h3>Chapter 10 Exercises</h3>
<p>This example will illustrate how functions can be used to “reperform”
a certain block of code. The example used will be similar to the task of
extracting samples in a working paper during an external audit and will
therefore display the utility of functions in practice. We want to
create a summary of all entries per colours, with neat headings in
between. We are going to perform this two ways: first without using
function, and then using functions. Macros have already been written and
allocated to buttons that will enable this. Execute the ‘Run without
functions’ to get an idea of what is trying to be achieved. Inspect the
syntax of the function method and obtain an understanding of its
workings. You might note that using functions does not decrease the time
it takes to execute the macro, and nor does it really lead to less lines
of code being written. So what are the benefits of using functions
here?</p>
<ul>
<li>A certain action is only written once inside the function, thereby
decreasing the likelihood of coding errors when repeating code
throughout the macro.</li>
<li>It is easier to read</li>
<li>When coding, it is easier to pass new data to existing functions,
rather than needing to apply computational thinking again in rewriting
code.</li>
</ul>
</div>
</div>
<div id="solutions" class="section level1">
<h1>Solutions</h1>
<div id="chapter-1" class="section level3">
<h3><u>Chapter 1</u></h3>
<p>Using “range”:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B1&quot;</span>).Value = <span class="st">&quot;Roger&quot;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B2&quot;</span>).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B3&quot;</span>).Value = 1981</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B4&quot;</span>).Value = 40</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B6&quot;</span>).Value = Range(<span class="st">&quot;B3&quot;</span>).Value + Range(<span class="st">&quot;B4&quot;</span>).Value</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;C9:E11&quot;</span>).Value = 420</span></code></pre></div>
<p>Using “cells”:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Cells(1,2).Value = <span class="st">&quot;Roger&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>Cells(2,2).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>Cells(3,2).Value = 1981</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>Cells(4,2).Value = 40</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>Cells(6,2).Value = Cells(3,2).Value + Cells(4,2).Value</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>Range(Cells(9,3),Cells(11,5)).Value = 420</span></code></pre></div>
</div>
<div id="chapter-2" class="section level3">
<h3><u>Chapter 2</u></h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> nameSurname <span class="kw">As</span> <span class="dt">String</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>nameSurname = <span class="st">&quot;Hamman Schoonwinkel&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B1&quot;</span>).Value = nameSurname</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> yearBirth <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>yearBirth = 1993</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B2&quot;</span>).Value = yearBirth</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> age <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>age = Range(<span class="st">&quot;F1&quot;</span>).Value</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B3&quot;</span>).Value = age</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> idNumber <span class="kw">As</span> <span class="dt">Double</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>idNumber = 9305266058079</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B4&quot;</span>).Value = idNumber</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> currentYear <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>currentYear = yearBirth + age</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B6&quot;</span>).Value = currentYear</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>age = age + 5</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>currentYear = yearBirth + age</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B6&quot;</span>).Value = currentYear</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>i = Range(<span class="st">&quot;B10&quot;</span>).Value</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> j <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>j = Range(<span class="st">&quot;B11&quot;</span>).Value</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>Cells(i, j).Value = <span class="st">&quot;Federer&quot;</span></span></code></pre></div>
</div>
<div id="chapter-3" class="section level3">
<h3><u>Chapter 3</u></h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Question 1</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;C1&quot;</span>).Value &gt; 37.5 <span class="kw">Then</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    Range (<span class="st">&quot;C2&quot;</span>).Value = <span class="st">&quot;Covid warning&quot;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Question 2</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;C4&quot;</span>).Value &gt;=18 <span class="kw">Then</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C5&quot;</span>).Value = <span class="st">&quot;You may enter&quot;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C5&quot;</span>).Value = <span class="st">&quot;You may not enter&quot;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Question 3</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;C7&quot;</span>).Value &gt;= 40 <span class="kw">And</span> Range(<span class="st">&quot;C8&quot;</span>).Value &gt;= 80 <span class="kw">Then</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C9&quot;</span>).Value = <span class="st">&quot;Yes&quot;</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C9&quot;</span>).Value = <span class="st">&quot;No&quot;</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Question 4</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;C11&quot;</span>).Value &lt;= 30 <span class="kw">Or</span> Range(<span class="st">&quot;C12&quot;</span>).Value &lt;= 50 <span class="kw">Then</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C13&quot;</span>).Value = <span class="st">&quot;Yes&quot;</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C13&quot;</span>).Value = <span class="st">&quot;No&quot;</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
</div>
<div id="chapter-4" class="section level3">
<h3><u>Chapter 4</u></h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A4&quot;</span>).Copy Range(<span class="st">&quot;C6&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A12:B15&quot;</span>).Copy Range(<span class="st">&quot;E15&quot;</span>) <span class="co">&#39;or Range(&quot;A12&quot;).CurrentRegion.Copy Range(&quot;E15&quot;)</span></span></code></pre></div>
</div>
<div id="chapter-5" class="section level3">
<h3><u>Chapter 5</u></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrow <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>lastrow = cells(rows.count,1).End(xlUp).row</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;G1&quot;</span>).Value = lastrow</span></code></pre></div>
</div>
<div id="chapter-6" class="section level3">
<h3><u>Chapter 6</u></h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> name <span class="kw">as</span> <span class="dt">String</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> yearOfBirth <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> age <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> addEntryRow <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>addEntryRow = cells(rows.count,1).End(xlUp).row + 1</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>name = InputBox(<span class="st">&quot;Please enter your name:&quot;</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>yearOfBirth = InputBox(<span class="st">&quot;Please enter your year of birth:&quot;</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>age = 2022 - yearOfBirth</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>addEntryRow = cells(rows.count,1).End(xlUp).row + 1</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>cells(addEntryRow,1).Value = name</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>cells(addEntryRow,2).Value = yearOfBirth</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>cells(addEntryRow,3).Value = age</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>MsgBox <span class="st">&quot;Entry added succesfully&quot;</span></span></code></pre></div>
</div>
<div id="chapter-7" class="section level3">
<h3><u>Chapter 7</u></h3>
</div>
<div id="part-i-1" class="section level3">
<h3>Part I</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> cityWs <span class="kw">as</span> Worksheet</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> unitedWs <span class="kw">as</span> Worksheet</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> combinedWs <span class="kw">as</span> Worksheet</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>cityWs = Worksheets(<span class="st">&quot;Manchester City&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>unitedWs = Worksheets(<span class="st">&quot;Manchester United&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>combinedWs = Worksheets(<span class="st">&quot;All Manchester&quot;</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine city range and copy and paste over to combined sheet:</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowCity <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>lastrowCity = cityWs.cells(rows.count,1).End(xlUp).row</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>cityWs.Range(cityWs.Cells(2,1),cityWs.Cells(lastrowCity,5)).Copy combinedWs.Range(<span class="st">&quot;A2&quot;</span>)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine united range and copy and paste over to combined sheet:</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowUnited <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>lastrowUnited = unitedWs.cells(rows.count,1).End(xlUp).row</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>startPaste = combinedWs.cells(rows.count,1).End(xlUp).row + 1</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>unitedWs.Range(unitedWs.Cells(2,1),unitedWs.Cells(lastrowUnited,5)).Copy combinedWs.Cells(startPaste,1)</span></code></pre></div>
</div>
<div id="part-ii-1" class="section level3">
<h3>Part II</h3>
<p>First macro:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;This code was just copied as provided in Chapter 6</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> fnameList, fnameCurFile <span class="kw">As</span> Variant</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> countFiles, countSheets <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> wksCurSheet <span class="kw">As</span> Worksheet</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> wbkCurBook, wbkSrcBook <span class="kw">As</span> Workbook</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>fnameList = Application.GetOpenFilename(FileFilter:=<span class="st">&quot;Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm&quot;</span>, Title:=<span class="st">&quot;Choose Excel files to merge&quot;</span>, MultiSelect:=<span class="kw">True</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>(vbBoolean &lt;&gt; VarType(fnameList)) <span class="kw">Then</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>(UBound(fnameList) &gt; 0) <span class="kw">Then</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>        countFiles = 0</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>        countSheets = 0</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>        Application.ScreenUpdating = <span class="kw">False</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>        Application.Calculation = xlCalculationManual</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">Set </span>wbkCurBook = ActiveWorkbook</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">For </span>Each fnameCurFile In fnameList</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>            countFiles = countFiles + 1</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">Set </span>wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">For </span>Each wksCurSheet In wbkSrcBook.Sheets</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>                countSheets = countSheets + 1</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">Next</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>            wbkSrcBook.Close SaveChanges:=<span class="kw">False</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">Next</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        Application.ScreenUpdating = <span class="kw">True</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        Application.Calculation = xlCalculationAutomatic</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>         MsgBox <span class="st">&quot;Processed &quot;</span> &amp; countFiles &amp; <span class="st">&quot; files&quot;</span> &amp; vbCrLf &amp; <span class="st">&quot;Merged &quot;</span> &amp; countSheets &amp; <span class="st">&quot;             worksheets&quot;</span>, Title:=<span class="st">&quot;Merge Excel files&quot;</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    MsgBox <span class="st">&quot;No files selected&quot;</span>, Title:=<span class="st">&quot;Merge Excel files&quot;</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
<p>Second macro:</p>
<p>At this stage we now have one workbook containing three worksheets.
Note that the sheets imported appear at the end. As worksheets are added
to the workbook, it starts at the right. So first it imported the August
sheet (depending on which one you clicked first, probably August if your
files are sorted alphabetically) and added it to the right. Then it
imported the July sheet and added it to the right, thereby making August
now the middle sheet. Also note that these new sheets are not titled by
their original workbook name. We will therefore have to refer to them by
reference to their order, rather than their name, as we would not know
their new name before importing.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> julyWs <span class="kw">As</span> Worksheet</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> augustWs <span class="kw">As</span> Worksheet</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> combinedWs <span class="kw">As</span> Worksheet</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Now reference sheets by order!</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>julyWs = Worksheets(3)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>augustWs = Worksheets(2)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>combinedWs = Worksheets(1)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine July range and copy and paste over to combined sheet:</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowJuly <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>lastrowJuly = julyWs.Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>julyWs.Range(julyWs.Cells(2, 1), julyWs.Cells(lastrowJuly, 6)).Copy combinedWs.Range(<span class="st">&quot;A2&quot;</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine August range and copy and paste over to combined sheet:</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowAugust <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>lastrowAugust = augustWs.Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>startPaste = combinedWs.Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>augustWs.Range(augustWs.Cells(2, 1), augustWs.Cells(lastrowAugust, 6)).Copy combinedWs.Cells(startPaste, 1)</span></code></pre></div>
</div>
<div id="chapter-8" class="section level3">
<h3><u>Chapter 8</u></h3>
</div>
<div id="part-i-2" class="section level3">
<h3>Part I</h3>
<div class="sourceCode" id="cb11"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastRow <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> 7</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    lastRow = Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    startPaste = Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    Worksheets(i).Range(Worksheets(i).Cells(2, 1), Worksheets(i).Cells(lastRow, 3)).Copy Worksheets(1).Cells(startPaste, 1)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="part-ii-2" class="section level3">
<h3>Part II</h3>
<p>First import separate workbooks into the one workbook as separate
worksheets:</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>Refer <span class="kw">to</span> template code in Chapter 6</span></code></pre></div>
<p>Then rename each sheet to its respective colour:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">integer</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">to</span> 7</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    Worksheets(i).Name = Worksheets(i).Range(<span class="st">&quot;B2&quot;</span>).Value</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>Then merge separate datasets into one dataset:</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> j <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastRow <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> 7</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    lastRow = Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    startPaste = Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    Worksheets(i).Range(Worksheets(i).Cells(2, 1),  Worksheets(i).Cells(lastRow, 3)).Copy Worksheets(1).Cells(startPaste, 1)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="part-iii" class="section level3">
<h3>Part III</h3>
<div class="sourceCode" id="cb15"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span> <span class="co">&#39;will be used to loop through entries</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> j <span class="kw">As</span> <span class="dt">Integer</span> <span class="co">&#39;will be used to loop through worksheets</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastRow <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>lastRow = Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Loop through each entry in merged dataset</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> lastRow</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">&#39;Loop through each worksheet and find the colour</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">For </span>j = 2 <span class="kw">To</span> 7</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">If </span>Worksheets(j).Name = Worksheets(1).Cells(i, 2).Value <span class="kw">Then</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>            startPaste = Worksheets(j).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>            Worksheets(1).Range(Worksheets(1).Cells(i, 1), Worksheets(1).Cells(i, 3)).Copy Worksheets(j).Cells(startPaste, 1)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">End If</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Next </span>j</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>MsgBox <span class="st">&quot;Extract performed succesfully&quot;</span></span></code></pre></div>
</div>
<div id="part-iv" class="section level3">
<h3>Part IV</h3>
<div class="sourceCode" id="cb16"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastRow <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> messWs <span class="kw">As</span> Worksheet</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> tidyWs <span class="kw">As</span> Worksheet</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> colour <span class="kw">As</span> <span class="dt">String</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>messWs = Worksheets(<span class="st">&quot;SemiStructured&quot;</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>tidyWs = Worksheets(<span class="st">&quot;Structured&quot;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>lastRow = messWs.Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 1 <span class="kw">To</span> lastRow</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>messWs.Cells(i, 1).Value = <span class="st">&quot;Colour:&quot;</span> <span class="kw">Then</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>        colour = messWs.Cells(i, 2).Value</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    ElseIf messWs.Cells(i, 1).Value = <span class="st">&quot;Date&quot;</span> <span class="kw">Then</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&#39;do nothing</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Else</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>        startPaste = tidyWs.Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>        tidyWs.Cells(startPaste, 1).Value = messWs.Cells(i, 1).Value</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>        tidyWs.Cells(startPaste, 2).Value = colour</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>        tidyWs.Cells(startPaste, 3).Value = messWs.Cells(i, 2).Value</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="part-v" class="section level3">
<h3>Part V</h3>
<p>Invoice button:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> accNumber <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> invoiceAmount <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Enter account number</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>accNumber = InputBox(<span class="st">&quot;Enter account number:&quot;</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Enter invoice amount</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>invoiceAmount = InputBox(<span class="st">&quot;Enter invoice amount:&quot;</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Find sheet</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> 39</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>Worksheets(i).Name = accNumber <span class="kw">Then</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>        startPaste = Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 1).Value = <span class="dt">Date</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 2).Value = <span class="st">&quot;Invoice&quot;</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 3).Value = invoiceAmount</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 4).Value = Worksheets(i).Cells(startPaste - 1, 4).Value + Worksheets(i).Cells(startPaste, 3).Value</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>        MsgBox <span class="st">&quot;Invoice succesfully added&quot;</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Activate</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>Payment button:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> accNumber <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> paymentAmount <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Enter account number</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>accNumber = InputBox(<span class="st">&quot;Enter account number:&quot;</span>)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Enter payment amount</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>paymentAmount = InputBox(<span class="st">&quot;Enter payment amount: (positive)&quot;</span>)</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Find sheet</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> 39</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>Worksheets(i).Name = accNumber <span class="kw">Then</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>        startPaste = Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 1).Value = <span class="dt">Date</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 2).Value = <span class="st">&quot;Payment&quot;</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 3).Value = paymentAmount * -1</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 4).Value = Worksheets(i).Cells(startPaste - 1, 4).Value + Worksheets(i).Cells(startPaste, 3).Value</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>        MsgBox <span class="st">&quot;Payment succesfully added&quot;</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Activate</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="chapter-9" class="section level3">
<h3><u>Chapter 9</u></h3>
<p>Solution already provided in the workbook</p>
</div>
<div id="chapter-10" class="section level3">
<h3><u>Chapter 10</u></h3>
<p>Solution already provided in the workbook</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
