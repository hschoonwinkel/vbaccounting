<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>project1.knit</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Excel VBA</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Textbook
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./project1.html">Theory</a>
    </li>
    <li>
      <a href="./project2.html">Exercises</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/githubusername/mywebsite">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">




</div>


<div id="chapter-1-assign-values" class="section level1">
<h1>Chapter 1: Assign values</h1>
<div id="assign-values-to-a-single-cell" class="section level5">
<h5>Assign values to a single cell</h5>
<div class="sourceCode" id="cb1"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1&quot;</span>).value = 1</span></code></pre></div>
<p><img src="Images/image-20211221143953077.png" alt="image-20211221143953077" style="zoom:100%;" /></p>
</div>
<div id="assign-value-to-a-single-cell-alternative"
class="section level5">
<h5>Assign value to a single cell (alternative)</h5>
<div class="sourceCode" id="cb2"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Cells(1,1).Value = 1</span></code></pre></div>
<p>The first number in the brackets (before the comma) refers to the
row, while the second number refers to the column.</p>
</div>
<div id="assign-value-to-a-range-of-cells" class="section level5">
<h5>Assign value to a range of cells</h5>
<div class="sourceCode" id="cb3"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1:C1&quot;</span>).Value = 1</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144041760.png"
alt="" />
<p class="caption">image-20211221144041760</p>
</div>
</div>
<div id="assign-value-to-a-range-of-cells-alternative"
class="section level5">
<h5>Assign value to a range of cells (alternative)</h5>
<div class="sourceCode" id="cb4"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Range(Cells(1,1),Cells(1,3)).Value = 1</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144041760.png"
alt="" />
<p class="caption">image-20211221144041760</p>
</div>
<p>Cells(1,1) refers to the cell with row 1 column 1, which is A1.
Cells(1,3) refers to the cell with row 1 column 3, which is C1. By
placing them within the range function, separated by a comma, it is read
as: Range A1:C1. Using the cells format, whereby the cell is referred to
by expressing the row number and column number (e.g. cell(1,3)) might
read more difficult than simply expressing the cell address (e.g. C1),
but the cell format is very useful when looping (to be discussed in
Chapter 8).</p>
</div>
<div id="assigning-value-text-to-a-single-cell" class="section level5">
<h5>Assigning value (text) to a single cell</h5>
<div class="sourceCode" id="cb5"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1&quot;</span>).Value = <span class="st">&quot;Federer&quot;</span></span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144116675.png"
alt="" />
<p class="caption">image-20211221144116675</p>
</div>
<p>Note how you need to place a string in quotation marks, while it is
not required for a number.</p>
</div>
<div id="chapter-1-exercises" class="section level3">
<h3>Chapter 1 Exercises</h3>
<p>Use the workbook provided and complete the form provided by entering
your details in the provided blue areas, using VBA. Code your questions
to all the below questions within one macro in the VB Editor. Rerun your
macro after completing each question, to make sure your macro works
correctly. Refer to the cell address by using “range”. Thereafter,
reperform all the below questions in a new macro, by referring to the
cell addresses by using “cells”.</p>
<p>Q1: Enter your name in cell B1. Q2: Enter your surname in cell B2.
Q3: Enter your year of birth in cell B3. Q4: Enter your age in cell B4.
Q5: Calculate the current year in cell B6, by adding your year of birth
(B3) to your age (B4). Q6: Assign all cells in the range C9:E11 equal to
the value of 420.</p>
</div>
</div>
<div id="chapter-2-variables" class="section level1">
<h1>Chapter 2: Variables</h1>
<p>Variables are placeholders in which values or ranges can be stored.
First, the variable needs to be declared. Next, a value should be
assigned to that variable. Thereafter, the variable can be used
throughout the code by referring to the name of that variable, which
holds the value originally assigned to it.</p>
<div
id="assign-variable-equal-to-a-value-and-set-the-value-of-another-cell-equal-to-that-variable"
class="section level5">
<h5>Assign variable equal to a value and set the value of another cell
equal to that variable</h5>
<div class="sourceCode" id="cb6"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> apple <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>apple = 20</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1&quot;</span>).Value = apple</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144136398.png"
alt="" />
<p class="caption">image-20211221144136398</p>
</div>
<p>In the 1st line, we declare a variable. When declaring a variable, we
start with the word “Dim”. We give the variable the name “apple”. It is
also important to instruct the VB editor what <strong>type</strong> of
variable you want to create. In this instance, we create an integer.
Variable types that exist are:</p>
<ul>
<li>Integer: Number that is not a decimal</li>
<li>Single: Number that may be a decimal form</li>
<li>Double: Number that is large (&gt;32 767)</li>
<li>String: Any text</li>
<li>Date: Any date</li>
</ul>
<p>If we try to declare a variable as type integer, and assign it the
value of 50 000, it would not work. If we know our numbers are going to
be large, we would need to declare a variable as type double. You might
be wondering: why don’t we then just always use double in stead of
integer? The reason is that a double takes up more computer memory than
an integer, which would make your code unnecessarily slower, if you are
working with small numbers.</p>
<p>In the 2nd line, we assign the variable named “apple” equal to the
value of 20.</p>
<p>In the 3rd line, we assign cell A3 equal to the value of “apple”. As
apple has the value of 20, as assigned in the previous step, cell A20
will hold the value of 20.</p>
<p>Note that it is possible to change the value of a variable in a later
stage of the code:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> apple <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>apple = 20</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1&quot;</span>).Value = apple</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>apple = 30</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B1&quot;</span>).Value = apple</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144201021.png"
alt="" />
<p class="caption">image-20211221144201021</p>
</div>
<p>In the 4th line, we reassign the variable named “apple” equal to a
new value of 30. Note that it was not necessary to redeclare the
variable. We only declare the variable once in our code initially. Also
note that despite the variable “apple” having changed value, and we
originally set cell A1 equal to the value of “apple”, the value of cell
A1 did not accordingly adjust to the new value of “apple” afterwards.
Code will always execute looking forward and not readjust previously
assigned values.</p>
<p>In the 5th line, we assign cell B1 equal to the value of “apple”. As
the variable “apple” now has a new value of 30, cell B1 is assigned the
value of 30.</p>
<p>It is also increment a variable with a certain value as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> apple <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>apple = 20</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1&quot;</span>).Value = apple</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>apple = apple + 10</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B1&quot;</span>).Value = apple</span></code></pre></div>
<p>In the 4th line, we increment the value of the apple variable with
10. The line says: Apple should now equal the value of what apple
currently is (before the execution of this 4th line), plus 10. As apple
is currently 20, and we now add 10 to it, apple will, after this line
has been executed, become 30. Cell B1 will therefore be assigned a value
of 30.</p>
</div>
<div
id="assign-variable-equal-to-a-value-as-found-in-existing-cell-and-set-the-value-of-another-cell-equal-to-that-variable"
class="section level5">
<h5>Assign variable equal to a value as found in existing cell and set
the value of another cell equal to that variable</h5>
<div class="sourceCode" id="cb9"><pre class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> banana <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>banana = Range(<span class="st">&quot;A1&quot;</span>).Value</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B1&quot;</span>).Value = banana</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144222888.png"
alt="" />
<p class="caption">image-20211221144222888</p>
</div>
<p>In the 1st line, we declare a variable named “banana” as type
integer. In the 2nd line we assign the variable “banana” equal to the
value as found in cell A1. As cell A1 contains the value of 8, “banana”
is assigned equal to the value of 8. In the 3rd line we assign cell B1
equal to the value of “banana”. As the value of “banana” is 8, cell B1
is assigned equal to the value of 8.</p>
</div>
<div
id="assign-variable-equal-to-a-value-and-use-that-to-determine-address-of-another-cell"
class="section level5">
<h5>Assign variable equal to a value and use that to determine address
of another cell</h5>
<div class="sourceCode" id="cb10"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> cherry <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>cherry = 3</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Cells(1,cherry).Value = 1</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144237571.png"
alt="" />
<p class="caption">image-20211221144237571</p>
</div>
<p>In the 1st line, we declare a variable named “cherry” as type
integer. In the 2nd line, we assign “cherry” equal to a value of 3. In
the third line, we assign the cell which has a row of “1” and a column
of “cherry” equal to the value of 1. As “cherry” has the value of 3, we
assign the cell which has a row of 1 and a column of 3 equal to the
value of 1. Row 1 with column 3 gives as cell C1, so we assign cell C1
equal to the value of 1.</p>
</div>
<div
id="assign-variable-equal-to-a-value-and-use-to-determine-address-of-a-range"
class="section level5">
<h5>Assign variable equal to a value and use to determine address of a
range</h5>
<div class="sourceCode" id="cb11"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> donut <span class="kw">as</span> <span class="dt">integer</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>donut = 1</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Range(cells(1,donut),cells(1,donut+2)).Value = 5</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144255368.png"
alt="" />
<p class="caption">image-20211221144255368</p>
</div>
<p>In the 1st line, we declare a variable named “donut” as type integer.
In the 2nd line, we assign “donut” equal to a value of 1. In the third
line, we assign a certain range equal to the value of 5. This range is
from a certain cell to another cell. The first cell is the cell with a
row of 1 and a column of “donut”. As donut is equal to 1, this first
cell is the cell with row 1 and column 1, i.e. A1. The second cell is
the cell with a row of 1 and a column of [donut+2]. As donut is equal to
1, it is a column of [1+2], therefore 3. Therefore this second cell is
the cell with a row of 1 and a column of 3, i.e. C1. The range is
therefore from A1 to C1. We assign this range equal to a value of 5.</p>
</div>
<div id="chapter-2-exercises" class="section level3">
<h3>Chapter 2 Exercises</h3>
<p>Use the workbook provided and complete the form provided by entering
your details in the provided blue areas, using VBA within one macro.
Rerun the macro after each question to test accuracy.</p>
<p>Q1: Declare a variable named ‘nameSurname’. Assign it a value equal
to your name and surname. Set the value of cell B1 equal to the value of
that variable.</p>
<p>Q2: Declare a variable named ‘yearBirth’. Assign it a value equal to
your year of birth. Set the value of cell B2 equal to the value of that
variable.</p>
<p>Q3: Declare a variable named ‘age’. Assign it a value equal to the
value as found in cell F1. Set the value of cell B3 equal to the value
of that variable.</p>
<p>Q4: Create a macro button for your macro created thus far.</p>
<p>Q5: Change the value in cell F1 to your actual age, using manual
traditional Excel (no VBA).</p>
<p>Q6: Rerun the macro created in Q3, by pressing the button created in
Q4. Did the value in cell B3 change to your actual age? If not, you did
not do Q3 correctly. Make sure you did not “hard code” the age into your
formula by expressing it directly, but rather expressed that the age
should equal whatever value is found in cell F1.</p>
<p>Q7: Declare a variable named ‘idNumber’. Assign it a value equal to
your ID number. Set the value of cell B4 equal to the value that
variable.</p>
<p>Q8: Declare a variable named ‘currentYear’. Assign it a value equal
to the ‘yearBirth’ variable plus the ‘age’ variable. Set the value of
cell B6 equal to the value of the ‘cuurentYear’ variable.</p>
<p>Q9: Increment the ‘age’ variable with 5. Rerun the macro. Nothing
will change on the sheet. The answer obtained in Q8 for cell B6 would
not change, despite referencing the ‘age’ variable, as we only changed
the value of the variable after that line of code.</p>
<p>Q10: Set the value of ‘currentYear’ once again equal to the
‘yearBirth’ variable plus the ‘age’ variable again. Set the value of
cell B6 equal to the value of that variable. Running the macro again
should now change the value in cell B6 by incrementing it with 5, as the
‘age’ variable, which is used to calculate the ‘currentYear’ value, has
incremented with 5 in the previous line of code.</p>
<p>Q11: Declare a variable named ‘i’. Set it equal to the value as found
in cell B10. Then declare a variable named ‘j’ and set it equal to the
value as found in cell B11. Then set the value of the cell with the row
of i and column j equal to the text value “Federer” (in the VB
Editor).</p>
<p>Q12: Change the values in cells B10 and B11 to any numbers of your
liking, using manual traditional Excel (no VBA).</p>
<p>Q13: Rerun the macro in which your code for Q11 was placed. In which
cell did the word “Federer” now appear? Did the word “Federer” still
appear in cell D17 as well, or did the contents in cell D17 disappear?
Why/why not?</p>
</div>
</div>
<div id="chapter-3-if-statement" class="section level1">
<h1>Chapter 3: If statement</h1>
<div id="if-then" class="section level5">
<h5>If Then</h5>
<div class="sourceCode" id="cb12"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;A1&quot;</span>).Value &gt;= 50 <span class="kw">Then</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;B1&quot;</span>).Value = <span class="st">&quot;Passed&quot;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144314500.png"
alt="" />
<p class="caption">image-20211221144314500</p>
</div>
<div class="figure">
<img
src="Images/image-20211221144334824.png"
alt="" />
<p class="caption">image-20211221144334824</p>
</div>
<p>In the 1st line, we test whether the value as found in cell A1 is
larger (or equal) than 50. If this condition is met, then cell B1 should
be assigned the value of “Passed” (remember that strings should be
placed in quotations). It is then important to remember to close the If
statement with the expression “End If”. In the first screenshot, the
condition is met, and therefore B1 is assigned the value “Passed”. In
the second screenshot, the condition is not met, and the compiler simply
skips the line of code after the “then” statement. Cell B1 is therefore
not assigned the value of “Passed”.</p>
</div>
<div id="if-then-else" class="section level5">
<h5>If Then Else</h5>
<div class="sourceCode" id="cb13"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;A1&quot;</span>).Value &gt;= 50 <span class="kw">Then</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;B1&quot;</span>).Value = <span class="st">&quot;Passed&quot;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;B1&quot;</span>).Value = <span class="st">&quot;Failed&quot;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144314500.png"
alt="" />
<p class="caption">image-20211221144314500</p>
</div>
<div class="figure">
<img
src="Images/image-20211221144355635.png"
alt="" />
<p class="caption">image-20211221144355635</p>
</div>
<p>In this example, we instruct the compiler to do something <u>else</u>
when a condition is <u>not</u> met. In the 1st line, we test whether the
value as found in cell A1 is larger (or equal) than 50. If this
condition is met, then cell B1 should be assigned the value of “Passed”.
If the condition is not met (in other words, the value is smaller than
50), then cell B1 should be assigned the value of “Failed”. In the first
screenshot, the condition is met, and therefore B1 is assigned the value
“Passed”. In the second screenshot, the condition is not met, as 30 is
lower than 50, and therefore B1 is assigned the value “Failed”.</p>
</div>
<div id="if-then-with-and" class="section level5">
<h5>If Then with And</h5>
<div class="sourceCode" id="cb14"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;A1&quot;</span>).Value &gt;=50 <span class="kw">And</span> Range(<span class="st">&quot;B1&quot;</span>).Value &gt;=50 <span class="kw">Then</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C1&quot;</span>).Value = <span class="st">&quot;Passed&quot;</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C1&quot;</span>).Value = <span class="st">&quot;Failed&quot;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144455017.png"
alt="" />
<p class="caption">image-20211221144455017</p>
</div>
<div class="figure">
<img
src="Images/image-20211221144521172.png"
alt="" />
<p class="caption">image-20211221144521172</p>
</div>
<p>In the above example, two conditions need to be met in order for a
certain action to execute. Firstly, the value as found in cell A1 should
be larger (or equal) than 50. Secondly, the value as found in cell B1
should be larger (or equal) than 50. Only if both conditions are met,
cell C1 should be assigned the value of “Passed”. Otherwise, cell C1
should be assigned the value of “Failed”. In the first screenshot, both
numbers are larger than 50, and therefore cell C1 displays “Passed”. In
the second screenshot, only one of the conditions is met, i.e. the value
as found in cell A1 is larger than 50, but not the value as found in
cell B1. As the And-function requires both conditions to be met, the
word “Failed” would rather be displayed in cell C1.</p>
</div>
<div id="if-then-with-or" class="section level5">
<h5>If Then with Or</h5>
<div class="sourceCode" id="cb15"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;A1&quot;</span>).Value &gt;=50 <span class="kw">Or</span> Range(<span class="st">&quot;B1&quot;</span>).Value &gt;=50 <span class="kw">Then</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C1&quot;</span>).Value = <span class="st">&quot;Passed&quot;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C1&quot;</span>).Value = <span class="st">&quot;Failed&quot;</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144535135.png"
alt="" />
<p class="caption">image-20211221144535135</p>
</div>
<div class="figure">
<img
src="Images/image-20211221144549588.png"
alt="" />
<p class="caption">image-20211221144549588</p>
</div>
<p>In the above example, either of the two conditions need to be met in
order for a certain action to execute. Either the value as found in cell
A1 should be larger (or equal) than 50, or the value as found in cell B1
should be larger (or equal) than 50. As long as one of these conditions
are met, cell C1 should be assigned the value of “Passed”. Otherwise,
cell C1 should be assigned the value of “Failed”. In the first
screenshot, both numbers are smaller than 50, and therefore cell C1
displays “Failed”, as neither conditions were met. In the second
screenshot, one of the conditions is met, i.e. the value as found in
cell A1 is larger than 50, but not the value as found in cell B1. As the
Or-function only requires one of the stated conditions to be met, the
word “Passed” is displayed in Cell C1.</p>
</div>
<div id="chapter-3-exercises" class="section level3">
<h3>Chapter 3 Exercises</h3>
<p>Use the workbook provided and code your questions to all the below
questions within one macro in the VB Editor. Rerun your macro after
completing each question, to make sure your macro works correctly.</p>
<p>Q1: Enter a body temperature in cell C1, using manual traditional
Excel (no VBA). Using VBA, write code that would display the message
“Covid warning” in cell C2 if the temperature entered in cell C1 is
above 37,5 degrees Celsius.</p>
<p>Q2: Enter an age in cell C4, using manual traditional Excel (no VBA).
Using VBA, write code that would display the message “You may enter” in
cell C5 if the age entered in cell C4 is 18 or above. Otherwise, the
message “You may not enter” should appear.</p>
<p>Q3: Enter a cricket batting average (usually between 10 and 50) in
cell C17 and a batting strike rate (usually between 70 and 120) in cell
C8, using manual traditional Excel (no VBA). Batsmen are picked for the
cricket team if both of the following conditions are met: their batting
average should be 40 or higher, and their batting strike rate should be
80 or higher. Write Using VBA, write code that would display the message
“Yes” in cell C9 if the batsmen should be picked for the team. The
message “No” should appear if the batsmen should not be picked for the
team.</p>
<p>Q4: Enter a cricket bowling average (usually between 20 and 40) in
cell C11 and a bowling strike rate (usually between 40 and 60) in cell
C12, using manual traditional Excel (no VBA). Bowlers are picked for the
cricket team if either of the following conditions are met: their
bowling average should be 30 or lower, or their bowling strike rate
should be 50 or lower. Write Using VBA, write code that would display
the message “Yes” in cell C13 if the bowler should be picked for the
team. The message “No” should appear if the bowler should not be picked
for the team.</p>
<p>You can change your values in the blue input cells and rerun your
macro to make sure that your macro correctly caters for all possible
scenarios.</p>
</div>
</div>
<div id="chapter-4-copy-paste" class="section level1">
<h1>Chapter 4: Copy &amp; Paste</h1>
<div id="copy-and-paste-a-single-cell" class="section level5">
<h5>Copy and Paste a single cell</h5>
<div class="sourceCode" id="cb16"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1&quot;</span>).Copy Range(<span class="st">&quot;C1&quot;</span>)</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144626765.png"
alt="" />
<p class="caption">image-20211221144626765</p>
</div>
<p>In the above example, we copied the content of a cell and pasted it
into another cell. Note how we did not explicitly coded the paste
function. The VB Editor will paste the selection copied to the range
expressed after the copy function.</p>
</div>
<div id="copy-and-paste-a-range" class="section level5">
<h5>Copy and Paste a range</h5>
<div class="sourceCode" id="cb17"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1:B2&quot;</span>).Copy Range(<span class="st">&quot;D1&quot;</span>)</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144643850.png"
alt="" />
<p class="caption">image-20211221144643850</p>
</div>
<p>In the above example, we copied the the content as found in a range,
and pasted it to another area. Note how we instructed the VB editor were
to start pasting the range copied (D1).</p>
<p>It is also possible to select the whole range by referring to the
current region:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A1&quot;</span>).CurrentRegion.Copy Range(<span class="st">&quot;D1&quot;</span>)</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144648185.png"
alt="" />
<p class="caption">image-20211221144648185</p>
</div>
<p>The “Current Region” function in VBA is equivalent to pressing
“Ctrl+A” to select the whole area in standard Excel.</p>
</div>
<div id="chapter-4-exercises" class="section level3">
<h3>Chapter 4 Exercises</h3>
<p>Use the workbook provided and code your questions to all the below
questions within one macro in the VB Editor. Rerun your macro after
completing each question, to make sure your macro works correctly.</p>
<p>Q1: Copy the contents of cell A4 and paste it to cell C6. Q2: Copy
the contents of the range A12:B15 and paste it to E15:G18</p>
</div>
</div>
<div id="chapter-5-determine-last-row" class="section level1">
<h1>Chapter 5: Determine last row</h1>
<p>Being able to determine the last row of a database is a vital tool in
Excel VBA. The reason <u>why</u> it is useful will become clear in
chapter 7. In Chapter 5 we will solely on <u>how</u> to determine the
last row.</p>
<div id="method-1-move-down-from-top-of-database-not-recommended"
class="section level5">
<h5>Method 1: Move down from top of database (not recommended)</h5>
<div class="sourceCode" id="cb19"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrow <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>lastrow = cells(1,1).End(xlDown).row</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;D1&quot;</span>).Value = lastrow</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144721915.png"
alt="" />
<p class="caption">image-20211221144721915</p>
</div>
<p>We declare a variable with the name “lastrow” as type integer. We
then assign it a value calculated as follows: first we start at the cell
with row 1 and column 1, which is cell A1. The “End(xlDown)” part
instructs the compiler to move to down to the last row in the selection
that contains data. This is equivalent in pressing “Ctrl+↓” in standard
Excel. After this we are standing at cell A6. “.row” instructs the
compiler to determine the row of that cell, which is 6. The variable
lastrow is therefore assigned the value of 6. We then assigned cell D1
equal to the value of lastrow, which is 6.</p>
<p>Although the code was able to correctly determine the last row, this
method is not recommended, as it will not work if there are gaps in the
database. For example:</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrow <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>lastrow = cells(1,1).End(xlDown).row</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;D1&quot;</span>).Value = lastrow</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144747042.png"
alt="" />
<p class="caption">image-20211221144747042</p>
</div>
<p>We declare a variable with the name “lastrow” as type integer. We
then assign it a value calculated as follows: first we start at the cell
with row 1 and column 1, which is cell A1. The “End(xlDown)” part
instructs the compiler to move to down to the last row in the selection
that contains data. After this we are standing at cell A3. “.row”
instructs the compiler to determine the row of that cell, which is 3.
The variable lastrow is therefore assigned the value of 3. This is
incorrect, as the last row of the database is in fact 7. This method of
determining the last row did not work, as there was an empty cell (A4)
within our database.</p>
</div>
<div id="method-2-move-up-from-bottom-of-spreadsheet-recommended"
class="section level5">
<h5>Method 2: Move up from bottom of spreadsheet (recommended)</h5>
<div class="sourceCode" id="cb21"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrow <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>lastrow = cells(rows.count,1).End(xlUp).row</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;D1&quot;</span>).value = lastrow</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221144810825.png"
alt="" />
<p class="caption">image-20211221144810825</p>
</div>
<p>We declare a variable with the name “lastrow” as type integer. We
then assign it a value calculated as follows: first we start at a cell.
“rows.count” will count the total rows that the sheet contains, which
will always be 1048576. So we start with a cell that has row 1048576 and
column 1. This gives us cell A1048576. The “End(xlUp)” part instructs
the compiler to move to up to the first row that contains data. This is
equivalent in pressing “Ctrl+↑” in standard Excel. After this we are
standing at cell A7. “.row” instructs the compiler to determine the row
of that cell, which is 7. The variable lastrow is therefore assigned the
value of 7. We then assigned cell D1 equal to the value of lastrow,
which is 7.</p>
<p>This method is recommended, as it will always work, regardless of
whether your database contains empty cells.</p>
</div>
<div id="chapter-5-exercises" class="section level3">
<h3>Chapter 5 Exercises</h3>
<p>Use the workbook provided and declare a variable named “lastrow” and
assign it a value equal to the lastrow of the database given. Assign
cell G1 equal to the value of the ‘lastrow’ variable.</p>
</div>
</div>
<div id="chapter-6-boxes" class="section level1">
<h1>Chapter 6: Boxes</h1>
<div id="message-box" class="section level3">
<h3>Message box</h3>
<p>A message box can increase the user friendliness of a macro, by
giving information to the user after certain code has been executed. An
example would be to tell the user that the macro has been successfully
executed. This is done as follows:</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>VBA.MsgBox <span class="st">&quot;Determination of last row complete&quot;</span></span></code></pre></div>
<p>The above code will generate the following message box:</p>
<p><img src="Images/image-20211220163137643.png" alt="image-20211220163137643" style="zoom:80%;" /></p>
<p>The first component in the MsgBox function is the actual message that
should be displayed. There are other optional arguments t</p>
</div>
<div id="input-box" class="section level3">
<h3>Input box</h3>
<p>An input box enables you to create a message box in which the user
can input information. It is useful to then store this information as a
variable, and use it further in your code.</p>
<div class="sourceCode" id="cb23"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> a1weight <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>a1weight = InputBox(<span class="st">&quot;Enter the weight of A1:&quot;</span>)</span></code></pre></div>
<p><img src="Images/image-20211220163816484.png" alt="image-20211220163816484" style="zoom:80%;" /></p>
</div>
<div id="user-forms" class="section level3">
<h3>User forms</h3>
<p>When you need to obtain a lot of information from the user, it might
be better to make use of a user form, rather than several separate input
boxes. A user form looks like this:</p>
<div class="figure">
<img
src="Images/image-20220317154436343.png"
alt="" />
<p class="caption">image-20220317154436343</p>
</div>
<p>How to create a user form falls outside the scope of this
textbook.</p>
</div>
<div id="chapter-6-exercises" class="section level3">
<h3>Chapter 6 Exercises</h3>
<p>You are provided with a dataset containing a list of individuals,
containing their name, year of birth and age. A button, for which no
macro has yet been written, is also provided. When the button is
pressed, a message should appear, asking the user for his/her name.
After the user inputted a name and clicked OK, a new message should
appear, asking the user for his/her year of birth. After the user
inputted a number and clicked OK, the compiler should add an entry to
the dataset (tip: determine the last row as done in Chapter 5, and add
one to that variable to determine in which row the entry should be
added), containing the name, year of birth and the age in 2022 (which it
should calculate). A message should then appear, informing the user that
the entry has been successfully added.</p>
</div>
</div>
<div id="chapter-7-workbook-scopes" class="section level1">
<h1>Chapter 7: Workbook Scopes</h1>
<div id="worksheets" class="section level3">
<h3>Worksheets</h3>
<p>You often might be working in different worksheets within a workbook.
In such instances, it is vital to instruct the VB Editor to which sheet
you are referring, when referring to cells.</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A36&quot;</span>).Value = 10</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221162121108.png"
alt="" />
<p class="caption">image-20211221162121108</p>
</div>
<p>In the above example, we want to assign the value of 10 to cell A36.
But to which sheet? The VB Editor will by default use the sheet that it
currently active. However, when working with several sheets, it is
always good practice to explicitly express the sheet that should be
used, which is done as follows:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>Worksheets(<span class="st">&quot;January&quot;</span>).Range(<span class="st">&quot;A36&quot;</span>).Value = 10</span></code></pre></div>
<p>It is then also possible to write to different sheets within one
formula:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>Worksheets(<span class="st">&quot;February&quot;</span>).Range(<span class="st">&quot;C36&quot;</span>).Value = Worksheets(<span class="st">&quot;January&quot;</span>).Range(<span class="st">&quot;A36&quot;</span>).Value + 2</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221162219836.png"
alt="" />
<p class="caption">image-20211221162219836</p>
</div>
<p>It is also possible to assign worksheets to variables, which makes it
easier to code when used frequently:</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> janWs <span class="kw">as</span> Worksheet</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>janWs = Worksheets(<span class="st">&quot;January&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    janWs.Range(<span class="st">&quot;A35&quot;</span>).Value = 10</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    janWs.Range(<span class="st">&quot;A36&quot;</span>).Value = 12</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    JanWs.Range(<span class="st">&quot;A37&quot;</span>).Value = 14</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211221162304996.png"
alt="" />
<p class="caption">image-20211221162304996</p>
</div>
<p>Note in the above example that when assigning a value to a variable
which is of type “Worksheet”, it should be preceded with the word
“Set”.</p>
<div id="extensive-example" class="section level5">
<h5>Extensive example</h5>
<p>In this example, we are going to work with 3 worksheets within one
workbook:</p>
<ol style="list-style-type: decimal">
<li>Blue product: Worksheet containing sales related to our blue
product</li>
<li>Red product: Worksheet containing sales related to our red
product</li>
<li>Total: Worksheet in which all total sales (blue and red product)
should appear</li>
</ol>
<p>Here are screenshots of the data contained by the blue product
worksheet and red product worksheets, respectively:</p>
<div class="figure">
<img
src="Images/image-20211221162725076.png"
alt="" />
<p class="caption">image-20211221162725076</p>
</div>
<div class="figure">
<img
src="Images/image-20211221162746023.png"
alt="" />
<p class="caption">image-20211221162746023</p>
</div>
<p>We want to add these items together in a new worksheet. The final
result should be as follows:</p>
<div class="figure">
<img
src="Images/image-20211221162807516.png"
alt="" />
<p class="caption">image-20211221162807516</p>
</div>
<p>Assume that the following names were already allocated to the
respective worksheets:</p>
<div class="figure">
<img
src="Images/image-20211221162822579.png"
alt="" />
<p class="caption">image-20211221162822579</p>
</div>
<p>You can assume that the Total sheet already contains our
headings:</p>
<div class="figure">
<img
src="Images/image-20211221162843965.png"
alt="" />
<p class="caption">image-20211221162843965</p>
</div>
<p>The steps that we would need to follow is:</p>
<ol style="list-style-type: decimal">
<li>Copy the blue sales and paste it into the total sheet</li>
<li>Copy the red sales and paste it underneath the blue sales in the
total sheet</li>
</ol>
<p>Let us first declare variables for each worksheet and assign the
worksheets to it:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> blueWs <span class="kw">as</span> Worksheet</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> redWs <span class="kw">as</span> Worksheet</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> totalWs <span class="kw">as</span> Worksheet</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>blueWs = Worksheets(<span class="st">&quot;Blue&quot;</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>redWs = Worksheets(<span class="st">&quot;Red&quot;</span>)</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>totalWs = Worksheets(<span class="st">&quot;Total&quot;</span>)</span></code></pre></div>
<p><u>Step 1: Copy the blue sales and paste it into the total
sheet</u></p>
<p>The area of our blue sales can be found in the Blue worksheet in
cells A2:C8. We need to copy this area, and paste it into our totals
sheet. This can be done as follows:</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>blueWs.Range(<span class="st">&quot;A2:C8&quot;</span>).Copy totalWs.Range(<span class="st">&quot;A2&quot;</span>)</span></code></pre></div>
<p>However, we always want our code to be dynamic. We want our code to
always work, regardless of the size of our current database. For
example, next month we might have more than 7 sales entries for the blue
product, in which case the range that needs to be copied will differ. We
do not want to alter our code every month according to how big the
database is for that month, as that defeats the purpose of automation.
We want the VB Editor to determine the range itself, and then copy that
range over to the total sheet.</p>
<p>An option could be to use the “Current region” function:</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>blueWs.Range(<span class="st">&quot;A2&quot;</span>).CurrentRegion.Copy totalWs.Range(<span class="st">&quot;A2&quot;</span>)</span></code></pre></div>
<p>This would however not work, as it would then include the headings of
the blue worksheet. As the total worksheet already contains headings, we
only want to copy the entries itself (without headings) over.</p>
<p>Note that regardless of the quantity of sales entries, our data will
always start at cell A2, and will always only have 3 columns. The only
thing that can change with regards to our range, is the row where it
stops, as that would be determined by the quantities of sales made. We
will determine the last row of our database, as we learned how to do in
Chapter 5, in order to determine the range that needs to be copied:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowBlue <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>lastrowBlue = blueWs.cells(rows.count,1).End(xlUp).row</span></code></pre></div>
<p>The value of lastrowBlue would be 8.</p>
<p>Then we copy our range over, which would be determined as
follows:</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>blueWs.Range(blueWs.Cells(2,1),blueWs.Cells(lastrowBlue,3)).Copy totalWs.Range(<span class="st">&quot;A2&quot;</span>)</span></code></pre></div>
<p><em>Note how we explicitely state “blueWs” before the cells function
each item. This is explained at the end of chapter in note P.</em></p>
<p>Our range will start at the cell with row 2 and column 1, which is
cell A2. Our range will end at the cell with row “lastrowBlue” and
column 3. As “lastrowBlue” has a value of 8, our range will end at the
cell with row 8 and column 3, which is cell C8. Our range will therefore
be A1:C8. This range is copied and pasted to cell A2 within the Total
worksheet.</p>
<p>Our Total worksheet for therefore look as follows at this stage:</p>
<div class="figure">
<img
src="Images/image-20211221162725076.png"
alt="" />
<p class="caption">image-20211221162725076</p>
</div>
<p><u>Step 2: Copy the red sales and paste it underneath the blue sales
in the total sheet</u></p>
<p>The area of our red sales can be found in the Red worksheet in cells
A2:C5. But once again, we will determine this dynamically, by
determining the last row of the database:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowRed <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>lastrowRed = redWs.cells(rows.count,1).End(xlUp).row</span></code></pre></div>
<p>The variable ‘lastrowRed’ will be assigned a value of 5. Note how we
used different variables for the last row of the blue sales and the last
row of the red sales. This is good coding practice. No we want to
determine the range to be copied, and paste it beneath the blue sales in
the Total worksheet, i.e. starting at row 9. But once again, this should
be dynamic. It will not always necessarily be row 9 - it will depend on
the quantity of blue entries in the total sheet. We want our code to
always work, regardless of the size of our databases. We will therefore
also first determine the last row of our Total sheet, in order to
determine where to start pasting our red region:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>startPaste = totalWs.cells(rows.count,1).End(xlUp).row + 1</span></code></pre></div>
<p>Note how we used the formula to calculate the last row, but added a 1
to the end. Remember that we do not want to start pasting our range at
the last row, but rather the row after the last row, hence the +1. We
can now copy and paste the red range:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>redWs.Range(redWs.Cells(2,1),redWs.Cells(lastrowRed,3)).Copy totalWs.Cells(startPaste,1)</span></code></pre></div>
<p>To summarize, the total code is as follows:</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> blueWs <span class="kw">as</span> Worksheet</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> redWs <span class="kw">as</span> Worksheet</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> totalWs <span class="kw">as</span> Worksheet</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>blueWs = Worksheets(<span class="st">&quot;Blue&quot;</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>redWs = Worksheets(<span class="st">&quot;Red&quot;</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>totalWs = Worksheets(<span class="st">&quot;Total&quot;</span>)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine blue range and copy and paste over to total sheet:</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowBlue <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>lastrowBlue = blueWs.cells(rows.count,1).End(xlUp).row</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>blueWs.Range(blueWs.Cells(2,1),blueWs.Cells(lastrowBlue,3)).Copy totalWs.Range(<span class="st">&quot;A2&quot;</span>)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine red range and copy and paste over to total sheet:</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowRed <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>lastrowRed = redWs.cells(rows.count,1).End(xlUp).row</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>startPaste = totalWs.cells(rows.count,1).End(xlUp).row + 1</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>redWs.Range(redWs.Cells(2,1),redWs.Cells(lastrowRed,3)).Copy totalWs.Cells(startPaste,1)</span></code></pre></div>
<p>Note the comments inserted in the code above. Comments are inserted
into the VB Editor by starting with a ’ sign. The VB Editor will ignore
those lines when executing the code. Comments make it easier to
understand code written.</p>
<p>The final result of the code will now be as follows:</p>
<div class="figure">
<img
src="Images/image-20211221162807516.png"
alt="" />
<p class="caption">image-20211221162807516</p>
</div>
<p>Great success.</p>
</div>
</div>
<div id="workbooks" class="section level3">
<h3>Workbooks</h3>
<p>You often might be working with several workbooks within one macro.
In such a case, it is suggested that you first import all separate
workbooks into one single workbook as separate worksheets. Thereafter,
you can work with the separate worksheets as discussed earlier. Below is
the code which would, as soon as it is run, allow the user to select
workbook files via a file browser. The files selected will then be
imported as separate worksheets within the workbook in which the macro
is coded.</p>
<p>Code to import separate workbooks:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> fnameList, fnameCurFile <span class="kw">As</span> Variant</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> countFiles, countSheets <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> wksCurSheet <span class="kw">As</span> Worksheet</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> wbkCurBook, wbkSrcBook <span class="kw">As</span> Workbook</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>fnameList = Application.GetOpenFilename(FileFilter:=<span class="st">&quot;Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm&quot;</span>, Title:=<span class="st">&quot;Choose Excel files to merge&quot;</span>, MultiSelect:=<span class="kw">True</span>)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>(vbBoolean &lt;&gt; VarType(fnameList)) <span class="kw">Then</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>(UBound(fnameList) &gt; 0) <span class="kw">Then</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>        countFiles = 0</span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>        countSheets = 0</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        Application.ScreenUpdating = <span class="kw">False</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>        Application.Calculation = xlCalculationManual</span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">Set </span>wbkCurBook = ActiveWorkbook</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">For </span>Each fnameCurFile In fnameList</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>            countFiles = countFiles + 1</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>            <span class="kw">Set </span>wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>            <span class="kw">For </span>Each wksCurSheet In wbkSrcBook.Sheets</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>                countSheets = countSheets + 1</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a>                wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)</span>
<span id="cb37-23"><a href="#cb37-23" aria-hidden="true" tabindex="-1"></a>            <span class="kw">Next</span></span>
<span id="cb37-24"><a href="#cb37-24" aria-hidden="true" tabindex="-1"></a>            wbkSrcBook.Close SaveChanges:=<span class="kw">False</span></span>
<span id="cb37-25"><a href="#cb37-25" aria-hidden="true" tabindex="-1"></a>        <span class="kw">Next</span></span>
<span id="cb37-26"><a href="#cb37-26" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-27"><a href="#cb37-27" aria-hidden="true" tabindex="-1"></a>        Application.ScreenUpdating = <span class="kw">True</span></span>
<span id="cb37-28"><a href="#cb37-28" aria-hidden="true" tabindex="-1"></a>        Application.Calculation = xlCalculationAutomatic</span>
<span id="cb37-29"><a href="#cb37-29" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb37-30"><a href="#cb37-30" aria-hidden="true" tabindex="-1"></a>         MsgBox <span class="st">&quot;Processed &quot;</span> &amp; countFiles &amp; <span class="st">&quot; files&quot;</span> &amp; vbCrLf &amp; <span class="st">&quot;Merged &quot;</span> &amp; countSheets &amp; <span class="st">&quot;             worksheets&quot;</span>, Title:=<span class="st">&quot;Merge Excel files&quot;</span></span>
<span id="cb37-31"><a href="#cb37-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb37-32"><a href="#cb37-32" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb37-33"><a href="#cb37-33" aria-hidden="true" tabindex="-1"></a>    MsgBox <span class="st">&quot;No files selected&quot;</span>, Title:=<span class="st">&quot;Merge Excel files&quot;</span></span>
<span id="cb37-34"><a href="#cb37-34" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
<p>The code above will not be explained and should simply be copied and
pasted into the VB Editor when used.</p>
<div id="note-p" class="section level5">
<h5>Note P</h5>
<p>We copied the ranges as follows:</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>redWs.Range(redWs.Cells(2,1),redWs.Cells(lastrowRed,3)).Copy</span></code></pre></div>
<p>It might seem odd that we have to restate ‘redWs’ again before the
cells reference, if we already state ‘redWs’ before the range referece.
It is indeed odd. To explore this, let us look at similar scenarios.</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ThisWorkbook.Worksheets(<span class="st">&quot;Sheet1&quot;</span>).Range(<span class="st">&quot;A1&quot;</span>).Value = 2</span></code></pre></div>
<p>In the above code, we have our main object, being this workbook. This
object is followed by a sub-object, being one of its worksheets. This
sub-object is followed by a sub-object, being one of its ranges. The VB
Editor assumes that when starting a new “level” of reference, you want
to keep the scopes of its predecessors.</p>
<p>It would therefore seem logical that the following code should
work:</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ThisWorkbook.Worksheets(<span class="st">&quot;Sheet1&quot;</span>).Range(cells(1,1),cells(5,1)).Value = 5</span></code></pre></div>
<p>When the code reaches cells A1 and A5, it should remember by its
logical order that we are busy within the scope of this workbook and the
worksheet titled sheet1?</p>
<p>Create a new blank Excel workbook, and add another sheet, so there
are two sheets: Sheet1 and Sheet2. Click on Sheet1 to make sure that
that sheet is active. Then paste the above code in the VB editor. The
code would execute perfectly:</p>
<div class="figure">
<img
src="Images/image-20211221171318594.png"
alt="" />
<p class="caption">image-20211221171318594</p>
</div>
<p>Now click on Sheet2 to make sure that that sheet is active.</p>
<p>Suddenly, you get the following error:</p>
<div class="figure">
<img
src="Images/image-20211221171601410.png"
alt="" />
<p class="caption">image-20211221171601410</p>
</div>
<p>Why on earth is that??? The reason is that a cells reference within a
range does not automatically assume you want to reference the same
worksheet for the cells as for the range, even though logically it seems
like it should. The cells reference therefore works a bit different than
other references, as it the VB Editor does <u>not</u> assume that when
starting a cells reference, you want to keep the scopes of its
predecessors, unlike the case with range references or worksheets
references. When you use the cell references, the VB Editor forgets
previous stated scopes, and starts fresh.</p>
<p>Let’s inspect the first code again:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ThisWorkbook.Worksheets(<span class="st">&quot;Sheet1&quot;</span>).Range(<span class="st">&quot;A1&quot;</span>).Value = 2</span></code></pre></div>
<p>the VB Editor reads it as follows:</p>
<ul>
<li>ThisWorkbook: Make sure we work within this workbook in which the
macro is written.</li>
<li>Worksheets(“Sheet1”): I am taking into account the previous workbook
reference, and now we are going to make sure we work within the
worksheet titled “Sheet1” within this workbook.</li>
<li>Range: I am taking into account the previous workbook reference as
well as the previous worksheet reference , and now we are going to make
sure we work within the range A1.</li>
</ul>
<p>Now let us add a cells reference:</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ThisWorkbook.Worksheets(<span class="st">&quot;Sheet1&quot;</span>).Range(cells(1,1),cells(5,1)).Value = 5</span></code></pre></div>
<p>the VB Editor reads it as follows:</p>
<ul>
<li>ThisWorkbook: Make sure we work within this workbook in which the
macro is written.</li>
<li>Worksheets(“Sheet1”): I am taking into account the previous workbook
reference, and now we are going to make sure we work within the
worksheet titled “Sheet1” within this workbook.</li>
<li>Range: I am taking into account the previous workbook reference as
well as the previous worksheet reference , and now we are going to make
sure we work within the range as will follow after this</li>
<li>Cells: I am completely going to ignore previous references and start
fresh. I am going to assume that cells(1,1) refers to cell A1 of the
current workbook of the current worksheet, and I am going to assume that
cells(5,1) refers to cell A5 of the current workbook of the current
worksheet.</li>
</ul>
<p>When we had Sheet1 active, the code worked, as the “current workbook”
and “current worksheets” that cells automatically uses, were by accident
the predeceasing references. But as soon as we activated Sheet2 we got
an error, because the VB Editor read it as follows: use cell A1 to A5
within the current worksheet, which is to be found in the worksheet
titled “Sheet1”. As the current worksheet is Sheet2, the code gives an
error. Therefore the need to explicitly state the previous references
before the cells reference again:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ThisWorkbook.Worksheets(<span class="st">&quot;Sheet1&quot;</span>).Range(ThisWorkbook.Worksheets(<span class="st">&quot;Sheet1&quot;</span>).cells(1,1),ThisWorkbook.Worksheets(<span class="st">&quot;Sheet1&quot;</span>).cells(5,1)).Value = 5</span></code></pre></div>
<p>When you correctly restate the references before the cells
references, it is referred to as “qualifying” your cells references.
Therefore the error when we did not restate it, is that our cells
references were unqualified.</p>
</div>
</div>
<div id="chapter-7-exercises" class="section level3">
<h3>Chapter 7 Exercises</h3>
</div>
<div id="part-i" class="section level3">
<h3>Part I</h3>
<p>Your are presented with 2 worksheets: one sheet containing players
from Manchester City Football Club, and the other sheet containing
players from Manchester United Football Club. In the third worksheet,
titled “All Manchester”, you want to combine these two pool of players
into one database. Using VBA, create code that would execute this.</p>
</div>
<div id="part-ii" class="section level3">
<h3>Part II</h3>
<p>Your are presented with 2 workbooks: one workbook containing item
sales for July, and the other workbook containing item sales for August.
In the third workbook, titled “Combined”, you want to combine these two
months of sales into one database. Two macros should be written inside
the Combined workbook. The first macro should import the separate July
and August workbooks as separate worksheets within the Combined workbook
(use the template code provided in Chapter 7). The second macro should
then combine these two months into one database.</p>
</div>
</div>
<div id="chapter-8-loops" class="section level1">
<h1>Chapter 8: Loops</h1>
<div id="loop-through-rows" class="section level5">
<h5>Loop through rows</h5>
<div class="sourceCode" id="cb44"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>i = 1 <span class="kw">to</span> 3</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>cells(i,1).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>In the 1st line, we declare a variable named “i”. This variable will
be used within our loop to determine the row in each iteration of the
loop.</p>
<p>Now we start our for-loop. “i = 1” indicates what value the variable
“i” should have in the first iteration of the loop. The “to 3” indicates
when this loop should stop. Within our loop, we set the value of the
cell with row i and column 1 equal to the value of the text
“Federer”.</p>
<ul>
<li>During the first iteration of the loop, i has the value of 1.
Cells(i,1) therefore refers to cell(1,1), which represents the cell with
row 1 column 1, which is A1. We therefore set cell A1 equal to the value
of the text “Federer”. The line “next i” states that this iteration of
the loop is now done, and i should be incremented.</li>
<li>After incremented, i now has the value of 2. Should the loop run
again? The loop should run until i equals 3, so yes. During the second
iteration of the loop, i has the value of 2. Cells(i,1) therefore refers
to cell(2,1), which represents the cell with row 2 column 1, which is
A2. We therefore set cell A2 equal to the value of the text “Federer”.
The line “next i” states that this iteration of the loop is now done,
and i should be incremented.</li>
<li>After incremented, i now has the value of 3. Should the loop run
again? The loop should run until i equals 3, so yes (note that it should
run for a last time until it reaches 3). During the third iteration of
the loop, i has the value of 3. Cells(i,1) therefore refers to
cell(3,1), which represents the cell with row 3 column 1, which is A3.
We therefore set cell A3 equal to the value of the text “Federer”. The
line “next i” states that this iteration of the loop is now done, and i
should be incremented.</li>
<li>After incremented, i now has the value of 4. Should the loop run
again? The loop should run until i equals 3, so no. The loop is
therefore done and will not execute again. The loop therefore executed 3
times. The first time, i was 1, the second time i was 2, and the third
time, i was 3. By letting the cell row being expressed as the variable
“i”, and the value of “i” changes after each loop, the row that is
effected by each iteration is different.</li>
</ul>
<p>The final result of the code is as follows:</p>
<div class="figure">
<img
src="Images/image-20211221163819671.png"
alt="" />
<p class="caption">image-20211221163819671</p>
</div>
</div>
<div id="loop-throw-rows---increment-variable-with-value-other-than-1"
class="section level5">
<h5>Loop throw rows - increment variable with value other than 1</h5>
<p>In the first example, i was automatically incremented with 1. What if
we wanted to increment with a value other than 1, after each iteration?
This is done with the “step” function.</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>i = 1 <span class="kw">to</span> 5 <span class="kw">Step</span> 2</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>cells(i,1).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>In the 1st line, we declare a variable named “i”. This variable will
be used within our loop to determine the row in each iteration of the
loop.</p>
<p>Now we start our for-loop. “i = 1” indicates what value the variable
“i” should have in the first iteration of the loop. The “to 5” indicates
when this loop should stop. “Step 2” indicates with what value “i”
should increment after each iteration, which in this case is 2. Within
our loop, we set the value of the cell with row i and column 1 equal to
the value of the text “Federer”.</p>
<ul>
<li>During the first iteration of the loop, i has the value of 1.
Cells(i,1) therefore refers to cell(1,1), which represents the cell with
row 1 column 1, which is A1. We therefore set cell A1 equal to the value
of the text “Federer”. The line “next i” states that this iteration of
the loop is now done, and i should be incremented with 2.</li>
<li>After incremented, i now has the value of 3. Should the loop run
again? The loop should run until i equals 5, so yes. During the second
iteration of the loop, i has the value of 3. Cells(i,1) therefore refers
to cell(3,1), which represents the cell with row 3 column 1, which is
A3. We therefore set cell A3 equal to the value of the text “Federer”.
The line “next i” states that this iteration of the loop is now done,
and i should be incremented with 2.</li>
<li>After incremented, i now has the value of 5. Should the loop run
again? The loop should run until (and including) i equals 5, so yes.
During the third iteration of the loop, i has the value of 5. Cells(i,1)
therefore refers to cell(5,1), which represents the cell with row 5
column 1, which is A5. We therefore set cell A5 equal to the value of
the text “Federer”. The line “next i” states that this iteration of the
loop is now done, and i should be incremented with 2.</li>
<li>After incremented, i now has the value of 7. Should the loop run
again? The loop should run until i equals 5, so no. The loop is
therefore done and will not execute again. The loop therefore executed 3
times. The first time, i was 1, the second time i was 3, and the third
time, i was 5. By letting the cell row being expressed as the variable
“i”, and the value of “i” changes after each loop, the row that is
effected by each iteration is different.</li>
</ul>
<p>The final result of the code is as follows:</p>
<div class="figure">
<img
src="Images/image-20211221163846630.png"
alt="" />
<p class="caption">image-20211221163846630</p>
</div>
</div>
<div
id="loop-through-rows---quantity-of-iterations-determined-by-value-in-cell"
class="section level5">
<h5>Loop through rows - quantity of iterations determined by value in
cell</h5>
<p>We want the user to enter a number in cell C1. We then want to create
a loop that will set the cells, starting at A1 and going down in column
A, equal to the value of the text “Federer”. How many times should the
loop iterate? Equal to the value as entered by the user in cell C1.</p>
<div class="figure">
<img
src="Images/image-20211221163923283.png"
alt="" />
<p class="caption">image-20211221163923283</p>
</div>
<div class="sourceCode" id="cb46"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> rowEnd <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>rowEnd = Range(<span class="st">&quot;C1&quot;</span>).Value</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>i = 1 <span class="kw">to</span> rowEnd</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>cells(i,1).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>Let us say that the user entered the value “6” in cell C1:</p>
<div class="figure">
<img
src="Images/image-20211221164004698.png"
alt="" />
<p class="caption">image-20211221164004698</p>
</div>
<p>The user then executes the macro, containing the code above.</p>
<p>In the 1st line, we declare a variable named “i”. This variable will
be used within our loop to determine the row in each iteration of the
loop. In the 2nd line, we declare a variable named “rowEnd”. This
variable would be used to determine when the loop should stop.</p>
<p>We set the variable rowEnd equal to the value as found in cell C1,
which is 6.</p>
<p>Now we start our loop. “i = 1” indicates what value the variable “i”
should have in the first iteration of the loop. The “to rowEnd”
indicates when this loop should stop. Within our loop, we set the value
of the cell with row i and column 1 equal to the value of the text
“Federer”.</p>
<ul>
<li>During the first iteration of the loop, i has the value of 1.
Cells(i,1) therefore refers to cell(1,1), which represents the cell with
row 1 column 1, which is A1. We therefore set cell A1 equal to the value
of the text “Federer”. The line “next i” states that this iteration of
the loop is now done, and i should be incremented.</li>
<li>After incremented, i now has the value of 2. Should the loop run
again? The loop should run until i equals rowEnd, which is 6, so yes.
During the second iteration of the loop, i has the value of 2.
Cells(i,1) therefore refers to cell(2,1), which represents the cell with
row 2 column 1, which is A2. We therefore set cell A2 equal to the value
of the text “Federer”. The line “next i” states that this iteration of
the loop is now done, and i should be incremented.</li>
<li>After incremented, i now has the value of 3. Should the loop run
again? The loop should run until i equals rowEnd, which is 6, so yes
(note that it should run for a last time until it reaches 3). During the
third iteration of the loop, i has the value of 3. Cells(i,1) therefore
refers to cell(3,1), which represents the cell with row 3 column 1,
which is A3. We therefore set cell A3 equal to the value of the text
“Federer”. The line “next i” states that this iteration of the loop is
now done, and i should be incremented.</li>
<li>The loop would keep on running, until (and including) the value of i
reaches rowEnd, which is 6.</li>
</ul>
<p>The final result of the code is as follows:</p>
<div class="figure">
<img
src="Images/image-20211221164039752.png"
alt="" />
<p class="caption">image-20211221164039752</p>
</div>
<p>If the user now clears the contents in column A, changes the number
in cell C1 to “4”, and re-executes the exact same macro, the final
result will be different:</p>
<div class="figure">
<img
src="Images/image-20211221164107659.png"
alt="" />
<p class="caption">image-20211221164107659</p>
</div>
</div>
<div id="loop-through-rows---value-in-each-cell-should-increment"
class="section level5">
<h5>Loop through rows - value in each cell should increment</h5>
<p>We want the user to enter a number in cell C1. We then want to create
a loop that will set the cells, starting at A1 and going down in column
A, equal to a certain number. How many times should the loop iterate?
Equal to the value as entered by the user in cell C1. In this example,
we do not want each cell to display the same value each time, as was the
case in the previous examples with the text “Federer”. We want each cell
to display a unique number. It should start with 1, and increment the
value it displays each time with 1.</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> rowEnd <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>rowEnd = Range(<span class="st">&quot;C1&quot;</span>).Value</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>i = 1 <span class="kw">to</span> rowEnd</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>cells(i,1).Value = i</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>Let us say that the user entered the value “6” in cell C1:</p>
<div class="figure">
<img
src="Images/image-20211221164004698.png"
alt="" />
<p class="caption">image-20211221164004698</p>
</div>
<p>The user then executes the macro, containing the code above.</p>
<p>In the 1st line, we declare a variable named “i”. This variable will
be used within our loop to determine the row in each iteration of the
loop, and also the value that should be displayed within the cell. In
the 2nd line, we declare a variable named “rowEnd”. This variable would
be used to determine when the loop should stop.</p>
<p>We set the variable rowEnd equal to the value as found in cell C1,
which is 6.</p>
<p>Now we start our loop. “i = 1” indicates what value the variable “i”
should have in the first iteration of the loop. The “to rowEnd”
indicates when this loop should stop. Within our loop, we set the value
of the cell with row i and column 1 equal to the value of i.</p>
<ul>
<li>During the first iteration of the loop, i has the value of 1.
Cells(i,1) therefore refers to cell(1,1), which represents the cell with
row 1 column 1, which is A1. We therefore set cell A1 equal to the value
of i, which is 1. The line “next i” states that this iteration of the
loop is now done, and i should be incremented.</li>
<li>During the second iteration of the loop, i has the value of 2.
Cells(i,1) therefore refers to cell(2,1), which represents the cell with
row 2 column 1, which is A2. We therefore set cell A2 equal to the value
of i, which is 2. The line “next i” states that this iteration of the
loop is now done, and i should be incremented.</li>
<li>During the third iteration of the loop, i has the value of 3.
Cells(i,1) therefore refers to cell(3,1), which represents the cell with
row 3 column 1, which is A3. We therefore set cell A3 equal to the value
of i. The line “next i” states that this iteration of the loop is now
done, and i should be incremented.</li>
<li>The loop would keep on running, until (and including) the value of i
reaches rowEnd, which is 6.</li>
</ul>
<p>The final result of the code is as follows:</p>
<div class="figure">
<img
src="Images/image-20211221164201266.png"
alt="" />
<p class="caption">image-20211221164201266</p>
</div>
</div>
<div id="loop-through-columns---value-in-each-cell-should-increment"
class="section level5">
<h5>Loop through columns - value in each cell should increment</h5>
<p>We want the user to enter a number in cell A3. We then want to create
a loop that will set the cells, starting at A1 and going towards the
right in row 1, equal to a certain number. How many times should the
loop iterate? Equal to the value as entered by the user in cell A3. We
want each cell to display a unique number. It should start with 1, and
increment the value it displays each time with 1.</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> columnEnd <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>columnEnd = Range(<span class="st">&quot;A3&quot;</span>).Value</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>i = 1 <span class="kw">to</span> columnEnd</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>cells(1,i).Value = i</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>Let us say that the user entered the value “6” in cell A3:</p>
<div class="figure">
<img
src="Images/image-20211221164229478.png"
alt="" />
<p class="caption">image-20211221164229478</p>
</div>
<p>The user then executes the macro, containing the code above.</p>
<p>In the 1st line, we declare a variable named “i”. This variable will
be used within our loop to determine the column in each iteration of the
loop, and also the value that should be displayed within the cell. In
the 2nd line, we declare a variable named “columnEnd”. This variable
would be used to determine when the loop should stop.</p>
<p>We set the variable columnEnd equal to the value as found in cell A3,
which is 6.</p>
<p>Now we start our loop. “i = 1” indicates what value the variable “i”
should have in the first iteration of the loop. The “to columnEnd”
indicates when this loop should stop. Within our loop, we set the value
of the cell with row i and column 1 equal to the value of i.</p>
<ul>
<li>During the first iteration of the loop, i has the value of 1.
Cells(1,i) therefore refers to cell(1,1), which represents the cell with
row 1 column 1, which is A1. We therefore set cell A1 equal to the value
of i, which is 1. The line “next i” states that this iteration of the
loop is now done, and i should be incremented.</li>
<li>During the second iteration of the loop, i has the value of 2.
Cells(1,2) therefore refers to cell(1,2), which represents the cell with
row 1 column 2, which is B1. We therefore set cell B1 equal to the value
of i, which is 2. The line “next i” states that this iteration of the
loop is now done, and i should be incremented.</li>
<li>During the third iteration of the loop, i has the value of 3.
Cells(1,i) therefore refers to cell(1,3), which represents the cell with
row 1 column 3, which is C1. We therefore set cell C1 equal to the value
of i. The line “next i” states that this iteration of the loop is now
done, and i should be incremented.</li>
<li>The loop would keep on running, until (and including) the value of i
reaches columnEnd, which is 6.</li>
</ul>
<p>The final result of the code is as follows:</p>
<div class="figure">
<img
src="Images/image-20211221164250950.png"
alt="" />
<p class="caption">image-20211221164250950</p>
</div>
</div>
<div id="loop-through-columns-and-rows-nested-loop"
class="section level5">
<h5>Loop through columns and rows (nested loop)</h5>
<p>Now shit is about to get real. We want the user to enter a value in
cell A6 that states how many columns the entries should have, and enter
a value in cell A7 that states how many rows the entries should have.
Each cell should display the text “Federer”. For example, if the user
enters the following amounts in cells A6 and A7:</p>
<div class="figure">
<img
src="Images/image-20211221164327376.png"
alt="" />
<p class="caption">image-20211221164327376</p>
</div>
<p>The output after executing the macro should be:</p>
<div class="figure">
<img
src="Images/image-20211221164405953.png"
alt="" />
<p class="caption">image-20211221164405953</p>
</div>
<p>The code will be:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> columnEnd <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> rowEnd <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> j <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>columnEnd = Range(<span class="st">&quot;A6&quot;</span>).Value</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>rowEnd = Range(<span class="st">&quot;A7&quot;</span>).Value</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>i = 1 <span class="kw">to</span> rowEnd</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for </span>j = 1 <span class="kw">to</span> columnEnd</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>        cells(i,j).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Next </span>j</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>In this example, we have a nested loop (loop within a loop). The
variable “i” will be used to represent the row number, while the
variable “j” will be used to represent the column number. We start with
the i loop, and then we have the j loop within the i loop. We refer to
the i loop as the outer loop, and the j loop as the inner loop.</p>
<p>We start with the first iteration of the i loop. i = 1</p>
<p>​ We start with the first iteration of the j loop. j=1. cells (i,j)
will be cells (1,1). We set A1 equal to “Federer”. ​ We start with the
second iteration of the j loop. j=2 . cells (i,j) will be cells (1,2).
We set B1 equal to “Federer”. ​ We start with the third iteration of the
j loop. j=3 . cells (i,j) will be cells (1,3). We set C1 equal to
“Federer”. ​ We start with the fourth iteration of the j loop. j=4 .
cells (i,j) will be cells (1,4). We set D1 equal to “Federer”. ​ The j
loop is complete. Move on to the next line of code.</p>
<p>We start with the first iteration of the i loop. i = 2</p>
<p>​ We start with the first iteration of the j loop. j=1. cells (i,j)
will be cells (2,1). We set A2 equal to “Federer”. ​ We start with the
second iteration of the j loop. j=2 . cells (i,j) will be cells (2,2).
We set B2 equal to “Federer”. ​ We start with the third iteration of the
j loop. j=3 . cells (i,j) will be cells (2,3). We set C2 equal to
“Federer”. ​ We start with the fourth iteration of the j loop. j=4 .
cells (i,j) will be cells (2,4). We set D2 equal to “Federer”. ​ The j
loop is complete. Move on to the next line of code.</p>
<p>We start with the first iteration of the i loop. i = 3</p>
<p>​ We start with the first iteration of the j loop. j=1. cells (i,j)
will be cells (3,1). We set A3 equal to “Federer”. ​ We start with the
second iteration of the j loop. j=2 . cells (i,j) will be cells (3,2).
We set B3 equal to “Federer”. ​ We start with the third iteration of the
j loop. j=3 . cells (i,j) will be cells (3,3). We set C3 equal to
“Federer”. ​ We start with the fourth iteration of the j loop. j=4 .
cells (i,j) will be cells (3,4). We set D3 equal to “Federer”. ​ The j
loop is complete. Move on to the next line of code.</p>
<p>The i loop is complete. Move on to the next line of code. No next
line. Code is finished.</p>
<p>The end result is:</p>
<div class="figure">
<img
src="Images/image-20211221164414807.png"
alt="" />
<p class="caption">image-20211221164414807</p>
</div>
<p>During the first iteration of the i loop, we kept i = 1, meaning we
stayed on row 1. We then loop through the columns of row 1, with the
help of the j loop four times. We then moved on to the second row, with
i being 2 in its second iteration. We then loop through the columns of
row 2, with the help of the j loop four times. Note how j starts again
being 1. The fact that the j loop was completed during the first
iteration of the i loop is irrelevant. It will start its loop again from
scratch.</p>
<p>An alternative approach could have been to make the column loop the
outer loop, and the row loop the inner loop. In that case you would
start with the column being 1, and then loop throw the rows within that
one column, and then move to the net column, etc. In this approach the
order in which the cells are completed would be: A1, A2, A3, B1, B2, B3,
C1, C2, C3, D1, D2, D3. You can try to modify the code to follow such an
approach, yourself.</p>
</div>
<div
id="loop-through-columns-and-rows-nested-loop-and-increment-the-value-to-be-displayed"
class="section level5">
<h5>Loop through columns and rows (nested loop) and increment the value
to be displayed</h5>
<p>This example would be similar to the previous example, except now we
do not want to display the text “Federer” in each cell. Rather, the
output should be a number that increments each time. For example, if the
user enters the following amounts in cells A6 and A7:</p>
<div class="figure">
<img
src="Images/image-20211221164327376.png"
alt="" />
<p class="caption">image-20211221164327376</p>
</div>
<p>The output after executing the macro should be:</p>
<div class="figure">
<img
src="Images/image-20211221164456762.png"
alt="" />
<p class="caption">image-20211221164456762</p>
</div>
<p>The code will be:</p>
<div class="sourceCode" id="cb50"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> columnEnd <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> rowEnd <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> j <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> val <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>columnEnd = Range(<span class="st">&quot;A6&quot;</span>).Value</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>rowEnd = Range(<span class="st">&quot;A7&quot;</span>).Value</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>val = 1</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>i = 1 <span class="kw">to</span> rowEnd</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="kw">for </span>j = 1 <span class="kw">to</span> columnEnd</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>cells(i,j).Value = val</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>val = val + 1</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>j</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>First iteration of the i loop. i = 1</p>
<p>1st iteration of the j loop. j=1. cells (i,j) is cells (1,1). We set
A1 equal to val, which is 1. Thereafter increment val with 1. 2nd
iteration of the j loop. j=2. cells (i,j) is cells (1,2). We set B1
equal to val, which is 2. Thereafter increment val with 1. 3rd iteration
of the j loop. j=3. cells (i,j) is cells (1,3). We set C1 equal to val,
which is 3. Thereafter increment val with 1. 4th iteration of the j
loop. j=4. cells (i,j) is cells (1,4). We set D1 equal to val, which is
4. Thereafter increment val with 1. The j loop is complete. Move on to
the next line of code.</p>
<p>Second iteration of the i loop. i = 2</p>
<p>1st iteration of the j loop. j=1. cells (i,j) is cells (2,1). We set
A2 equal to val, which is 5. Thereafter increment val with 1. 2nd
iteration of the j loop. j=2. cells (i,j) is cells (2,2). We set B2
equal to val, which is 6. Thereafter increment val with 1. 3rd iteration
of the j loop. j=3. cells (i,j) is cells (2,3). We set C2 equal to val,
which is 7. Thereafter increment val with 1. 4th iteration of the j
loop. j=4. cells (i,j) is cells (2,4). We set D2 equal to val, which is
8. Thereafter increment val with 1. The j loop is complete. Move on to
the next line of code.</p>
<p>Third iteration of the i loop. i = 3</p>
<p>1st iteration of the j loop. j=1. cells (i,j) is cells (3,1). We set
A3 equal to val, which is 5. Thereafter increment val with 1. 2nd
iteration of the j loop. j=2. cells (i,j) is cells (3,2). We set B3
equal to val, which is 6. Thereafter increment val with 1. 3rd iteration
of the j loop. j=3. cells (i,j) is cells (3,3). We set C3 equal to val,
which is 7. Thereafter increment val with 1. 4th iteration of the j
loop. j=4. cells (i,j) is cells (3,4). We set D3 equal to val, which is
8. Thereafter increment val with 1. The j loop is complete. Move on to
the next line of code.</p>
<p>The i loop is complete. Move on to the next line of code. No next
line. Code is finished.</p>
<p>The end result is:</p>
<div class="figure">
<img
src="Images/image-20211221164500551.png"
alt="" />
<p class="caption">image-20211221164500551</p>
</div>
</div>
<div id="loop-through-worksheets" class="section level5">
<h5>Loop through worksheets</h5>
<p>When referring to worksheets by their order, it is also possible to
loop through worksheets, by replacing the worksheet number with a
counter variable.</p>
<p>Let us assume we have a workbook containing 10 worksheets and we want
to assign the value “Federer” to cell A1 of each worksheet:</p>
<div class="sourceCode" id="cb51"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">integer</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 1 <span class="kw">to</span> 10</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    ThisWorkbook.Worksheets(i).Range(<span class="st">&quot;A1&quot;</span>).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="chapter-8-exercises" class="section level3">
<h3>Chapter 8 Exercises</h3>
</div>
<div id="part-i---merge-worksheets" class="section level3">
<h3>Part I - Merge Worksheets</h3>
<p>You are presented with a workbook containing sales made for each
colour product in separate sheets. Your task is to merge all these
separate datasets into one dataset in the worksheet titled ‘Merged’.</p>
<p>Tips: Loop through all colour worksheets (start at sheet 2) and for
each each sheet, determine the last row to determine the range to be
copied, and determine where to start pasting in the ‘Merged sheet’ (row
after its last row) and paste it over.</p>
</div>
<div id="part-ii---merge-workbooks" class="section level3">
<h3>Part II - Merge Workbooks</h3>
<p>Your are presented with separate workbooks containing sales made for
each colour product. Your tasks are to:</p>
<ol style="list-style-type: decimal">
<li>Import every workbook into one single workbook as separate
worksheets AND rename each worksheet to the colour of that dataset.</li>
<li>Merge all these separate datasets into one dataset.</li>
</ol>
</div>
<div id="part-iii---reverse-merge-extract" class="section level3">
<h3>Part III - Reverse Merge (Extract)</h3>
<p>Your are presented with a database containing sales made for all
colour products. Your task is to create a separate dataset for all
respective colours in separate worksheets (basically the reverse of task
2). After the macro has been executed, a message should appear informing
the user that the macro ran successfully. Allocate this macro to the
button provided.</p>
<p>Tips: You will have a loop within a loop. The outer loop will loop
through each entry in the dataset in the ‘Merged’ sheet, while the inner
loop will loop through each worksheet. First, loop through the entries
in the dataset. For each entry, we need to find the sheet who’s name
matches the colour of that product. This is done by looping through all
the colour worksheets, then if the name of the worksheet (in inner loop)
equals the colour of our entry (in the outer loop), then we need to
determine where to start pasting in that sheet, and paste the entry
there.</p>
</div>
<div id="part-iv---semi-structured-dataset" class="section level3">
<h3>Part IV - Semi Structured Dataset</h3>
<p>Your are presented with a database containing sales made for all
colour products. This dataset is semi-structured. Your task is to
transform this dataset into a structured relational dataset in the other
worksheet provided.</p>
<p>Tips: Create a variable that would store the colour name. Loop
through each row in the semi-structured dataset. If the value of the
cell in column A is “Colour:” then store the value next to it as the
value for the colour variable. If the value of the cell in column A is
“Date” then do nothing (just have no code in that if section). Otherwise
(if none of the previous two conditions are met), the date, amount and
colour of that entry should be pasted to the structured dataset. Note:
do not use copy and paste. Rather first assign column A of structured
dataset equal to the value as found in column A of the semi-structured
dataset, then assign column B of the structured dataset equal to
variable of colour at that stage, then assign column C of the structured
dataset equal to the value as found in column B of the semi-structured
dataset.</p>
</div>
<div id="part-v---balance-updates" class="section level3">
<h3>Part V - Balance Updates</h3>
<p>You are required to build a system that would enable a user to easily
add an invoice or payment to a customer account, and update its
outstanding balance accordingly.</p>
<p>You are presented with a workbook containing:</p>
<ul>
<li>A worksheet titled ‘Buttons’, containing two buttons</li>
<li>A worksheet for every customer, titled by its customer number.</li>
</ul>
<p>When clicking on the ‘Add invoice’ or ‘Add Payment’ button, a message
should appear asking the user to input the customer number to whom this
invoice/payment should be levied. After the user inputted the number and
clicked ‘OK’, a message should then appear asking the user to input the
invoice/payment amount. After the user inputted the amount and clicked
‘OK’, an entry should be added to the applicable customer account in
that worksheet, containing the date of the document (hint: use ‘today()’
function), the document type (pending on which button clicked), the
amount (if it is a payment, it should be negative), and the updated
balance of the customer. A message should then appear indicating to the
user that the transaction was added successfully.</p>
<p>Create two separate macros for each button respectively.</p>
</div>
</div>
<div id="chapter-9-arrays" class="section level1">
<h1>Chapter 9: Arrays</h1>
<p>An array is a type of variable that can store more than one value. It
is often more logical to store a range of values inside the same
variable as an array, rather than declaring each value as a separate
variable.</p>
<div id="basic-array---each-element-assigned-manually"
class="section level5">
<h5>Basic Array - each element assigned manually</h5>
<div class="sourceCode" id="cb52"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> playersArray(1 <span class="kw">To</span> 4) <span class="kw">as</span> <span class="dt">String</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>playersArray(1) = Range(<span class="st">&quot;A2&quot;</span>).Value</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>playersArray(2) = Range(<span class="st">&quot;A3&quot;</span>).Value</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>playersArray(3) = Range(<span class="st">&quot;A4&quot;</span>).Value</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>playersArray(4) = Range(<span class="st">&quot;A5&quot;</span>).Value</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;C1&quot;</span>).Value = playersArray(2)</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211226185543382.png"
alt="" />
<p class="caption">image-20211226185543382</p>
</div>
<p>In the first line, we declared an array variable. In the brackets, we
indicate the size of the array (how many elements it will hold) by
expressing where it should start and where it should end. We declare the
array as type “string”, as it will hold values of player names. We then
assigned values to each element within the array manually. We then set
cell C1 equal to the value of the 2nd element within the playersArray,
which is the string “Nadal”.</p>
</div>
<div id="multi-dimension-arrays---each-element-assigned-manually"
class="section level5">
<h5>Multi-Dimension Arrays - each element assigned manually</h5>
<div class="sourceCode" id="cb53"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> playersArray(1 <span class="kw">to</span> 4,1 <span class="kw">to</span> 3) <span class="kw">as</span> Variant</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>playersArray(1,1) = Range(<span class="st">&quot;A2&quot;</span>).Value</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>playersArray(1,2) = Range(<span class="st">&quot;B2&quot;</span>).Value</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>playersArray(1,3) = Range(<span class="st">&quot;C2&quot;</span>).Value</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>playersArray(2,1) = Range(<span class="st">&quot;A3&quot;</span>).Value</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>playersArray(2,2) = Range(<span class="st">&quot;B3&quot;</span>).Value</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>playersArray(2,3) = Range(<span class="st">&quot;C3&quot;</span>).Value</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;E1&quot;</span>).Value = playersArray(2,2)</span></code></pre></div>
<div class="figure">
<img
src="Images/image-20211226191837632.png"
alt="" />
<p class="caption">image-20211226191837632</p>
</div>
<p>The first dimension is represented by the rows. The second dimension
is represented by the columns. In the brackets, we first indicate the
size of the first dimension. There are 4 rows. After the comma, we
indicate the size of the second dimension. There are 3 columns. We then
declare the array as type “variant”, which is a way of telling the VB
Editor that the variable should be able to hold anything. This is
required for this multi-dimension array, as the player names are
strings, but their titles and ages are integers. We then assign values
to each element in the array, explicitly expressing both dimensions each
time.</p>
<div class="figure">
<img
src="Images/image-20211226191837632.png"
alt="" />
<p class="caption">image-20211226191837632</p>
</div>
</div>
<div id="dynamic-arrays---elements-assigned-via-reference-to-range"
class="section level5">
<h5>Dynamic Arrays - elements assigned via reference to range</h5>
<div class="sourceCode" id="cb54"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> playersArray() <span class="kw">As</span> Variant</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> arrayLastPos <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>arrayLastPos = Cells(Rows.Count, 1).End(xlUp).Row - 1</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="kw">ReDim</span> playersArray(1 <span class="kw">To</span> arrayLastPos, 1 <span class="kw">To</span> 3)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>playersArray = Range(cells(2,1),cells(arrayLastPos+1,3))</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;E1&quot;</span>).Value = playersArray(2, 2)</span></code></pre></div>
<p>In the first line, we declared an array variable. In the brackets, we
omit the size of the array. We then declare a variable called
“arrayLastPos” which will be used to determine how many elements the
first dimension of the array should hold , which is calculated as the
last row of the dataset, minus 1. We then “redeclare” the array, using
ReDim, now indicating the size the array should hold. Note how we use
the variable in indicating the size of the first dimension. Note that it
is necessary to first declare the array without indicating any size, and
only thereafter redeclare it with the appropriate size, when using
dynamic arrays (dynamic arrays refer to arrays where the size is
determined by the size of the presented dataset, which in this case we
calculated with “arrayLastPos”). When then assign whole range of the
dataset (excluding headings) to the array.</p>
</div>
<div id="chapter-9-exercises" class="section level3">
<h3>Chapter 9 Exercises</h3>
<p>You are presented with a sheet containing sales of red, blue, green
and yellow items respectively. The goal is to create an extract of each
colour to their own respective datasets. Macros have already been
written and allocated to buttons that will enable this. There are 3
methods that this exercise can be done, for which 3 separate macros were
created:</p>
<ol style="list-style-type: decimal">
<li><p>Copy and Paste: For each row, determine if it is a certain
colour, and if so, copy that region (line-item columns) and paste it
under the applicable colour heading.</p></li>
<li><p>Assign values: For each row, determine if it is a certain colour,
and if so, assign the cells of the first empty line under the colour
section equal to the values as found in that row in the complete
dataset.</p></li>
<li><p>Arrays: Assign the complete dataset to an array. Then create new
arrays for each colour. Loop through all elements of the total array,
and if the colour of that element is a certain colour, assign the
elements of that colour’s array equal to those values in the total
array. Then finally, assign the region of that colours extract equal to
the colours’ array.</p></li>
</ol>
<p>Inspect the syntax of the array method and obtain an understanding of
its workings.</p>
<p>The goal of this exercise is to indicate the difference in time it
takes to execute each macro (the extracts should be deleted each time
before executing the next macro, as they all result in the same thing).
You will notice that the first method could take up to a minute, while
the second method is a bit faster, and the third method (using arrays)
takes less than one second!</p>
</div>
</div>
<div id="chapter-10-functions" class="section level1">
<h1>Chapter 10: Functions</h1>
<p>Up until now we have written al our code within a block of code
called a sub procedure. For example:</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>myMacro()</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A1&quot;</span>).value = 1</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span></code></pre></div>
<p>In this chapter we are going to explore another type of block of code
that can be written in the VB Editor called a function. This function is
written outside of the sub procedure. Unlike a sub procedure, a function
cannot be run on its own. You therefore cannot create a macro button
that will run a function. You can however call the function from within
the sub procedure, which will execute the function.</p>
<div id="calling-a-function-from-within-a-sub-procedure"
class="section level5">
<h5>Calling a function from within a sub procedure</h5>
<div class="sourceCode" id="cb56"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>orderExample()</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A1&quot;</span>).Value = <span class="st">&quot;Roger&quot;</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Call</span> addSurname</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A3&quot;</span>).Value = <span class="st">&quot;Switzerland&quot;</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Function </span>addSurname()</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A2&quot;</span>).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="kw">End Function</span></span></code></pre></div>
<p>In the above example, we have a sub procedure called orderExample. In
the first line, cell A1 is assigned a value equal to the string “Roger”.
In the second line, a function called addSurname is called. The code
will them jump to that function and execute it. The function assigns
cell A2 a value equal to the string “Switzerland”. When the function is
complete, the code will jump back to the sub procedure, and resume
executing after the line in which the function was called. The cell A3
will therefore next be assigned a value equal to the string
“Switzerland”.</p>
<p>The purpose of using functions will become clear later in the
chapter. The sole purpose of the above example was to show the order in
which the code is read, when functions are called from within sub
procedures.</p>
</div>
<div id="example-1-modify-a-variable-no-passing-no-returning"
class="section level5">
<h5>Example 1: Modify a variable (no passing &amp; no returning)</h5>
<div class="sourceCode" id="cb57"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>firstExample ()</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A1&quot;</span>).Value = 50.75</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Call</span> convertToRand</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Function </span>convertToRand()</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A2&quot;</span>).Value = Range(<span class="st">&quot;A1&quot;</span>).Value * 14.98</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="kw">End Function</span></span></code></pre></div>
<div class="figure">
<img
src="Images/image-20220218123006575.png"
alt="" />
<p class="caption">image-20220218123006575</p>
</div>
<ol style="list-style-type: decimal">
<li>We set sell A1 equal to the value of 50.75</li>
<li>We then call the function called convertToRand</li>
<li>The convertToRand function assigns A2 equal to the value as found in
cell A1, multiplied by 14.98.</li>
</ol>
</div>
<div id="example-2-modify-a-variable-pass-but-no-return"
class="section level5">
<h5>Example 2: Modify a variable (pass, but no return)</h5>
<div class="sourceCode" id="cb58"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>secondExample()</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> dollarValue <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    dollarValue = 50.75</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Call</span> convertToRand(dollarValue)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="kw">End sub</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Function </span>convertToRand(priceToConvert <span class="kw">as</span> <span class="dt">Single</span>) <span class="co">&#39;declaration of function&#39;</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> randValue <span class="kw">as</span> <span class="dt">single</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    randValue = priceToConvert * 14.98</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A1&quot;</span>).Value = randValue</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="kw">End Function</span></span></code></pre></div>
<div class="figure">
<img
src="Images/image-20220218123119453.png"
alt="" />
<p class="caption">image-20220218123119453</p>
</div>
<p>In example 2, a value is passed by the sub procedure to the function.
This is done by including it as an argument in brackets when calling the
function within the sub procedure. The function will receive a copy of
this value, and then “work with it further” as per its code. In the
declaration line of creating the function, we place in brackets what
this function will be receiving. We create a variable in this argument
and define its type. It is important that the type it receives, agrees
to the type that is being sent to it by the sub procedure. Note how we
create a new variable called “priceToConvert” in the function, which
will receive a copy of the value of dollarValue. You might be tempted to
give this variable in the function argument the same name as the
variable being passed to it, as it is the same value. It is however good
coding practice to give the function variable a new name, as they are
not the same variable, but simply hold the same value, as the value of
the sub procedure variable is being copied to the function variable.</p>
<ol style="list-style-type: decimal">
<li>We declare a variable named dollarValue as of type single (number
that can hold decimals)</li>
<li>We assign it a value of 50.75</li>
<li>We call the function called convertToRand, and pass a value to the
function, it being the variable dollarValue</li>
<li>The convertToRand function receives a copy of the value being held
by dollarValue, and stores it as a variable named priceToConvert.</li>
<li>We declare a new variable in the convertToRand function called
randValue, and assign it a value equal to the value held by
priceToConvert, multiplied by 14.98</li>
<li>We then assign cell A1 equal to the value of randValue.</li>
</ol>
</div>
<div id="example-3-modify-a-variable-pass-return"
class="section level5">
<h5>Example 3: Modify a variable (pass &amp; return)</h5>
<div class="sourceCode" id="cb59"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>thirdExample()</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> dollarValue <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> randValue <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    dollarValue = 50.75</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    randValue = convertToRand(dollarValue)</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A1&quot;</span>).Value = randValue</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Function </span>convertToRand(priceToConvert <span class="kw">as</span> <span class="dt">Single</span>)</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    convertToRand = priceToConvert * 14.98</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a><span class="kw">End Function</span></span></code></pre></div>
<p>In example 3, the function does not only receive a copy of a
variable, but also returns a value to the sub procedure. This is done
by:</p>
<ul>
<li><p>in the sub procedure: assigning a variable within the sub
procedure equal to value determined by passing a value to a
function;</p></li>
<li><p>in the function: assign the name of the function equal to the
value you want the function to return to the sub procedure</p></li>
</ul>
<ol style="list-style-type: decimal">
<li>We declare variables named dollarValue and randValue as of type
single (number that can hold decimals)</li>
<li>We assign dollarValue a value of 50.75</li>
<li>We assign a value to randValue, which is determined by passing the
dollarValue variable to the convertToRand function</li>
<li>The convertToRand function receives a copy of the value being held
by dollarValue, and stores it as a variable named priceToConvert.</li>
<li>The value to be returned by the function to the sub procedure is
calculated as the value held by priceToConvert, which is the copy
received of dollarValue, multiplied by 14.98.</li>
<li>The value is returned by the function to the sub procedure, and the
value of randValue is now modified.</li>
<li>In the sub procedure, we assign cell A1 equal to the value of
randValue.</li>
</ol>
</div>
<div id="example-4-modify-several-variables-pass-return"
class="section level5">
<h5>Example 4: Modify several variables (pass &amp; return)</h5>
<div class="sourceCode" id="cb60"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>fourthExample()</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> dollarValue1 <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> dollarValue2 <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> dollarValue3 <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> randValue1 <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> randValue2 <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> randValue3 <span class="kw">as</span> <span class="dt">Single</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    dollarValue1 = 50.75</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    dollarValue2 = 30.55</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    dollarValue3 = 12.68</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    randValue1 = convertToRand(dollarValue1)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    randValue2 = convertToRand(dollarValue2)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    randValue3 = convertToRand(dollarValue3)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A1&quot;</span>).Value = randValue1</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A2&quot;</span>).Value = randValue2</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A3&quot;</span>).Value = randValue3</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="kw">Function </span>convertToRand(priceToConvert <span class="kw">as</span> <span class="dt">Single</span>)</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    convertToRand = priceToConvert * 14.98</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="kw">End Function</span></span></code></pre></div>
<p>In example 4, the purpose of using functions becomes a bit clearer.
We call the function multiple times in the sub procedure, which executes
whatever code is placed within the function each time. This declutters
the code when reading the sub procedure, as we can easily read what is
happening to each variable when being passed to the function, without
needing to “recode” the multiplication calculation each time.</p>
</div>
<div id="example-5-add-two-numbers-together" class="section level5">
<h5>Example 5: Add two numbers together</h5>
<div class="sourceCode" id="cb61"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>fithExample()</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> firstItem <span class="kw">as</span> <span class="dt">single</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> secondItem <span class="kw">as</span> <span class="dt">single</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> sumOfItems <span class="kw">as</span> <span class="dt">single</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    firstItem = 30.50</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    secondItem = 15.60</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    sumOfItems = addTogether(firstItem,secondItem)</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;A1&quot;</span>).Value = sumOfItems</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="kw">Function </span>addTogether(number1 <span class="kw">as</span> <span class="dt">Single</span>, number2 <span class="kw">as</span> <span class="dt">Single</span>)</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    addTogether = number1 + number2</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="kw">End Function</span></span></code></pre></div>
<p>In example 5, we pass more than one value to a function, by
expressing it as separate arguments.</p>
<div id="example-6-passing-an-array-to-a-function"
class="section level6">
<h6>Example 6: Passing an array to a function</h6>
<div class="sourceCode" id="cb62"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Sub </span>sixthExample()</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> dollarsArray() <span class="kw">as</span> Variant</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> randsArray() <span class="kw">as</span> Variant</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> arrayLastPos <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    arrayLastPos = Cells(Rows.Count,1).End(xlUp).Row - 1</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ReDim</span>  dollarsArray(1 <span class="kw">To</span> arrayLastPos)</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">ReDim</span>  randsArray(1 <span class="kw">To</span> arrayLastPos)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>    dollarsArray = Range(cells(2,1),cells(arrayLastPos+1,1))</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>    randsArray = convertToRand(dollarsArray)</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>    Range(cells(2,2),cells(arrayLastPos+1,2)).Value = randsArray</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="kw">End Sub</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a><span class="kw">Function </span>convertToRand(foreignArr <span class="kw">as</span> Variant)</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-17"><a href="#cb62-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> arrayLastPos <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb62-18"><a href="#cb62-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">integer</span></span>
<span id="cb62-19"><a href="#cb62-19" aria-hidden="true" tabindex="-1"></a>    arrayLastPos = Cells(Rows.Count,1).End(xlUp).Row - 1</span>
<span id="cb62-20"><a href="#cb62-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-21"><a href="#cb62-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for </span>i = 1 <span class="kw">to</span> arrayLastPos</span>
<span id="cb62-22"><a href="#cb62-22" aria-hidden="true" tabindex="-1"></a>    forreignArr(i).Value = forreignArr(i).Value * 14.98</span>
<span id="cb62-23"><a href="#cb62-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Next </span>i</span>
<span id="cb62-24"><a href="#cb62-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-25"><a href="#cb62-25" aria-hidden="true" tabindex="-1"></a>    convertToRand = forreignArr</span>
<span id="cb62-26"><a href="#cb62-26" aria-hidden="true" tabindex="-1"></a><span class="kw">End Function</span></span></code></pre></div>
</div>
</div>
<div id="extensive-example-extract-types-of-products"
class="section level3">
<h3>Extensive example: Extract types of products</h3>
<p>This example will illustrate how functions can be used to “reperform”
a certain block of code. The example used will be similar to the task of
extracting samples in a working paper during an external audit and will
therefore display the utility of functions in practice. We want to
create a summary of all entries per colours, with neat headings in
between. We are going to perform this two ways: first without using
function, and then using functions. Macros have already been written and
allocated to buttons that will enable this. Execute the ‘Run without
functions’ to get an idea of what is trying to be achieved. Inspect the
syntax of the function method and obtain an understanding of its
workings. You might note that using functions does not decrease the time
it takes to execute the macro, and nor does it really lead to less lines
of code being written. So what are the benefits of using functions
here?</p>
<ul>
<li>A certain action is only written once inside the function, thereby
decreasing the likelihood of coding errors when repeating code
throughout the macro.</li>
<li>It is easier to read</li>
<li>When coding, it is easier to pass new data to existing functions,
rather than needing to apply computational thinking again in rewriting
code.</li>
</ul>
</div>
</div>
<div id="exercises-solutions" class="section level1">
<h1>Exercises Solutions</h1>
<div id="chapter-1" class="section level3">
<h3><u>Chapter 1</u></h3>
<p>Using “range”:</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B1&quot;</span>).Value = <span class="st">&quot;Roger&quot;</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B2&quot;</span>).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B3&quot;</span>).Value = 1981</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B4&quot;</span>).Value = 40</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B6&quot;</span>).Value = Range(<span class="st">&quot;B3&quot;</span>).Value + Range(<span class="st">&quot;B4&quot;</span>).Value</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;C9:E11&quot;</span>).Value = 420</span></code></pre></div>
<p>Using “cells”:</p>
<div class="sourceCode" id="cb64"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>Cells(1,2).Value = <span class="st">&quot;Roger&quot;</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>Cells(2,2).Value = <span class="st">&quot;Federer&quot;</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>Cells(3,2).Value = 1981</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>Cells(4,2).Value = 40</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>Cells(6,2).Value = Cells(3,2).Value + Cells(4,2).Value</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>Range(Cells(9,3),Cells(11,5)).Value = 420</span></code></pre></div>
</div>
<div id="chapter-2" class="section level3">
<h3><u>Chapter 2</u></h3>
<div class="sourceCode" id="cb65"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> nameSurname <span class="kw">As</span> <span class="dt">String</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>nameSurname = <span class="st">&quot;Hamman Schoonwinkel&quot;</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B1&quot;</span>).Value = nameSurname</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> yearBirth <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>yearBirth = 1993</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B2&quot;</span>).Value = yearBirth</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> age <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>age = Range(<span class="st">&quot;F1&quot;</span>).Value</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B3&quot;</span>).Value = age</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> idNumber <span class="kw">As</span> <span class="dt">Double</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a>idNumber = 9305266058079</span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B4&quot;</span>).Value = idNumber</span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> currentYear <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>currentYear = yearBirth + age</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B6&quot;</span>).Value = currentYear</span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>age = age + 5</span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a>currentYear = yearBirth + age</span>
<span id="cb65-24"><a href="#cb65-24" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;B6&quot;</span>).Value = currentYear</span>
<span id="cb65-25"><a href="#cb65-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-26"><a href="#cb65-26" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb65-27"><a href="#cb65-27" aria-hidden="true" tabindex="-1"></a>i = Range(<span class="st">&quot;B10&quot;</span>).Value</span>
<span id="cb65-28"><a href="#cb65-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-29"><a href="#cb65-29" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> j <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb65-30"><a href="#cb65-30" aria-hidden="true" tabindex="-1"></a>j = Range(<span class="st">&quot;B11&quot;</span>).Value</span>
<span id="cb65-31"><a href="#cb65-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-32"><a href="#cb65-32" aria-hidden="true" tabindex="-1"></a>Cells(i, j).Value = <span class="st">&quot;Federer&quot;</span></span></code></pre></div>
</div>
<div id="chapter-3" class="section level3">
<h3><u>Chapter 3</u></h3>
<div class="sourceCode" id="cb66"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Question 1</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;C1&quot;</span>).Value &gt; 37.5 <span class="kw">Then</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    Range (<span class="st">&quot;C2&quot;</span>).Value = <span class="st">&quot;Covid warning&quot;</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Question 2</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;C4&quot;</span>).Value &gt;=18 <span class="kw">Then</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C5&quot;</span>).Value = <span class="st">&quot;You may enter&quot;</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C5&quot;</span>).Value = <span class="st">&quot;You may not enter&quot;</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Question 3</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;C7&quot;</span>).Value &gt;= 40 <span class="kw">And</span> Range(<span class="st">&quot;C8&quot;</span>).Value &gt;= 80 <span class="kw">Then</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C9&quot;</span>).Value = <span class="st">&quot;Yes&quot;</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C9&quot;</span>).Value = <span class="st">&quot;No&quot;</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Question 4</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>Range(<span class="st">&quot;C11&quot;</span>).Value &lt;= 30 <span class="kw">Or</span> Range(<span class="st">&quot;C12&quot;</span>).Value &lt;= 50 <span class="kw">Then</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C13&quot;</span>).Value = <span class="st">&quot;Yes&quot;</span></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    Range(<span class="st">&quot;C13&quot;</span>).Value = <span class="st">&quot;No&quot;</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
</div>
<div id="chapter-4" class="section level3">
<h3><u>Chapter 4</u></h3>
<div class="sourceCode" id="cb67"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A4&quot;</span>).Copy Range(<span class="st">&quot;C6&quot;</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;A12:B15&quot;</span>).Copy Range(<span class="st">&quot;E15&quot;</span>) <span class="co">&#39;or Range(&quot;A12&quot;).CurrentRegion.Copy Range(&quot;E15&quot;)</span></span></code></pre></div>
</div>
<div id="chapter-5" class="section level3">
<h3><u>Chapter 5</u></h3>
<div class="sourceCode" id="cb68"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrow <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>lastrow = cells(rows.count,1).End(xlUp).row</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>Range(<span class="st">&quot;G1&quot;</span>).Value = lastrow</span></code></pre></div>
</div>
<div id="chapter-6" class="section level3">
<h3><u>Chapter 6</u></h3>
<div class="sourceCode" id="cb69"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> name <span class="kw">as</span> <span class="dt">String</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> yearOfBirth <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> age <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> addEntryRow <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>addEntryRow = cells(rows.count,1).End(xlUp).row + 1</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>name = InputBox(<span class="st">&quot;Please enter your name:&quot;</span>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>yearOfBirth = InputBox(<span class="st">&quot;Please enter your year of birth:&quot;</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>age = 2022 - yearOfBirth</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>addEntryRow = cells(rows.count,1).End(xlUp).row + 1</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>cells(addEntryRow,1).Value = name</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>cells(addEntryRow,2).Value = yearOfBirth</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>cells(addEntryRow,3).Value = age</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>MsgBox <span class="st">&quot;Entry added succesfully&quot;</span></span></code></pre></div>
</div>
<div id="chapter-7" class="section level3">
<h3><u>Chapter 7</u></h3>
</div>
<div id="part-i-1" class="section level3">
<h3>Part I</h3>
<div class="sourceCode" id="cb70"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> cityWs <span class="kw">as</span> Worksheet</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> unitedWs <span class="kw">as</span> Worksheet</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> combinedWs <span class="kw">as</span> Worksheet</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>cityWs = Worksheets(<span class="st">&quot;Manchester City&quot;</span>)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>unitedWs = Worksheets(<span class="st">&quot;Manchester United&quot;</span>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>combinedWs = Worksheets(<span class="st">&quot;All Manchester&quot;</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine city range and copy and paste over to combined sheet:</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowCity <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>lastrowCity = cityWs.cells(rows.count,1).End(xlUp).row</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>cityWs.Range(cityWs.Cells(2,1),cityWs.Cells(lastrowCity,5)).Copy combinedWs.Range(<span class="st">&quot;A2&quot;</span>)</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine united range and copy and paste over to combined sheet:</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowUnited <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>lastrowUnited = unitedWs.cells(rows.count,1).End(xlUp).row</span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">as</span> <span class="dt">Integer</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>startPaste = combinedWs.cells(rows.count,1).End(xlUp).row + 1</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>unitedWs.Range(unitedWs.Cells(2,1),unitedWs.Cells(lastrowUnited,5)).Copy combinedWs.Cells(startPaste,1)</span></code></pre></div>
</div>
<div id="part-ii-1" class="section level3">
<h3>Part II</h3>
<p>First macro:</p>
<div class="sourceCode" id="cb71"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;This code was just copied as provided in Chapter 6</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> fnameList, fnameCurFile <span class="kw">As</span> Variant</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> countFiles, countSheets <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> wksCurSheet <span class="kw">As</span> Worksheet</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> wbkCurBook, wbkSrcBook <span class="kw">As</span> Workbook</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>fnameList = Application.GetOpenFilename(FileFilter:=<span class="st">&quot;Microsoft Excel Workbooks (*.xls;*.xlsx;*.xlsm),*.xls;*.xlsx;*.xlsm&quot;</span>, Title:=<span class="st">&quot;Choose Excel files to merge&quot;</span>, MultiSelect:=<span class="kw">True</span>)</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="kw">If </span>(vbBoolean &lt;&gt; VarType(fnameList)) <span class="kw">Then</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>(UBound(fnameList) &gt; 0) <span class="kw">Then</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>        countFiles = 0</span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a>        countSheets = 0</span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a>        Application.ScreenUpdating = <span class="kw">False</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a>        Application.Calculation = xlCalculationManual</span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">Set </span>wbkCurBook = ActiveWorkbook</span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>        <span class="kw">For </span>Each fnameCurFile In fnameList</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a>            countFiles = countFiles + 1</span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a>            <span class="kw">Set </span>wbkSrcBook = Workbooks.Open(Filename:=fnameCurFile)</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a>            <span class="kw">For </span>Each wksCurSheet In wbkSrcBook.Sheets</span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a>                countSheets = countSheets + 1</span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a>                wksCurSheet.Copy after:=wbkCurBook.Sheets(wbkCurBook.Sheets.Count)</span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a>            <span class="kw">Next</span></span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a>            wbkSrcBook.Close SaveChanges:=<span class="kw">False</span></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a>        <span class="kw">Next</span></span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>        Application.ScreenUpdating = <span class="kw">True</span></span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a>        Application.Calculation = xlCalculationAutomatic</span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a>         MsgBox <span class="st">&quot;Processed &quot;</span> &amp; countFiles &amp; <span class="st">&quot; files&quot;</span> &amp; vbCrLf &amp; <span class="st">&quot;Merged &quot;</span> &amp; countSheets &amp; <span class="st">&quot;             worksheets&quot;</span>, Title:=<span class="st">&quot;Merge Excel files&quot;</span></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a><span class="kw">Else</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a>    MsgBox <span class="st">&quot;No files selected&quot;</span>, Title:=<span class="st">&quot;Merge Excel files&quot;</span></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a><span class="kw">End If</span></span></code></pre></div>
<p>Second macro:</p>
<p>At this stage we now have one workbook containing three worksheets.
Note that the sheets imported appear at the end. As worksheets are added
to the workbook, it starts at the right. So first it imported the August
sheet (depending on which one you clicked first, probably August if your
files are sorted alphabetically) and added it to the right. Then it
imported the July sheet and added it to the right, thereby making August
now the middle sheet. Also note that these new sheets are not titled by
their original workbook name. We will therefore have to refer to them by
reference to their order, rather than their name, as we would not know
their new name before importing.</p>
<div class="sourceCode" id="cb72"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> julyWs <span class="kw">As</span> Worksheet</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> augustWs <span class="kw">As</span> Worksheet</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> combinedWs <span class="kw">As</span> Worksheet</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Now reference sheets by order!</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>julyWs = Worksheets(3)</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>augustWs = Worksheets(2)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>combinedWs = Worksheets(1)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine July range and copy and paste over to combined sheet:</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowJuly <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>lastrowJuly = julyWs.Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>julyWs.Range(julyWs.Cells(2, 1), julyWs.Cells(lastrowJuly, 6)).Copy combinedWs.Range(<span class="st">&quot;A2&quot;</span>)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Determine August range and copy and paste over to combined sheet:</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastrowAugust <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>lastrowAugust = augustWs.Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>startPaste = combinedWs.Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>augustWs.Range(augustWs.Cells(2, 1), augustWs.Cells(lastrowAugust, 6)).Copy combinedWs.Cells(startPaste, 1)</span></code></pre></div>
</div>
<div id="chapter-8" class="section level3">
<h3><u>Chapter 8</u></h3>
</div>
<div id="part-i-2" class="section level3">
<h3>Part I</h3>
<div class="sourceCode" id="cb73"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastRow <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> 7</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    lastRow = Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    startPaste = Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    Worksheets(i).Range(Worksheets(i).Cells(2, 1), Worksheets(i).Cells(lastRow, 3)).Copy Worksheets(1).Cells(startPaste, 1)</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="part-ii-2" class="section level3">
<h3>Part II</h3>
<p>First import separate workbooks into the one workbook as separate
worksheets:</p>
<div class="sourceCode" id="cb74"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>Refer <span class="kw">to</span> template code in Chapter 6</span></code></pre></div>
<p>Then rename each sheet to its respective colour:</p>
<div class="sourceCode" id="cb75"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">as</span> <span class="dt">integer</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">to</span> 7</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    Worksheets(i).Name = Worksheets(i).Range(<span class="st">&quot;B2&quot;</span>).Value</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>Then merge separate datasets into one dataset:</p>
<div class="sourceCode" id="cb76"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> j <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastRow <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> 7</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    lastRow = Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    startPaste = Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    Worksheets(i).Range(Worksheets(i).Cells(2, 1),  Worksheets(i).Cells(lastRow, 3)).Copy Worksheets(1).Cells(startPaste, 1)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="part-iii" class="section level3">
<h3>Part III</h3>
<div class="sourceCode" id="cb77"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span> <span class="co">&#39;will be used to loop through entries</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> j <span class="kw">As</span> <span class="dt">Integer</span> <span class="co">&#39;will be used to loop through worksheets</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastRow <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>lastRow = Worksheets(1).Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Loop through each entry in merged dataset</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> lastRow</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">&#39;Loop through each worksheet and find the colour</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">For </span>j = 2 <span class="kw">To</span> 7</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">If </span>Worksheets(j).Name = Worksheets(1).Cells(i, 2).Value <span class="kw">Then</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>            startPaste = Worksheets(j).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a>            Worksheets(1).Range(Worksheets(1).Cells(i, 1), Worksheets(1).Cells(i, 3)).Copy Worksheets(j).Cells(startPaste, 1)</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">End If</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Next </span>j</span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a>MsgBox <span class="st">&quot;Extract performed succesfully&quot;</span></span></code></pre></div>
</div>
<div id="part-iv" class="section level3">
<h3>Part IV</h3>
<div class="sourceCode" id="cb78"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> lastRow <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> messWs <span class="kw">As</span> Worksheet</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> tidyWs <span class="kw">As</span> Worksheet</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> colour <span class="kw">As</span> <span class="dt">String</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>messWs = Worksheets(<span class="st">&quot;SemiStructured&quot;</span>)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a><span class="kw">Set </span>tidyWs = Worksheets(<span class="st">&quot;Structured&quot;</span>)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>lastRow = messWs.Cells(Rows.Count, 1).End(xlUp).Row</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 1 <span class="kw">To</span> lastRow</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>messWs.Cells(i, 1).Value = <span class="st">&quot;Colour:&quot;</span> <span class="kw">Then</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>        colour = messWs.Cells(i, 2).Value</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    ElseIf messWs.Cells(i, 1).Value = <span class="st">&quot;Date&quot;</span> <span class="kw">Then</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>        <span class="co">&#39;do nothing</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">Else</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>        startPaste = tidyWs.Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>        tidyWs.Cells(startPaste, 1).Value = messWs.Cells(i, 1).Value</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>        tidyWs.Cells(startPaste, 2).Value = colour</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>        tidyWs.Cells(startPaste, 3).Value = messWs.Cells(i, 2).Value</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="part-v" class="section level3">
<h3>Part V</h3>
<p>Invoice button:</p>
<div class="sourceCode" id="cb79"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> accNumber <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> invoiceAmount <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Enter account number</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>accNumber = InputBox(<span class="st">&quot;Enter account number:&quot;</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Enter invoice amount</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>invoiceAmount = InputBox(<span class="st">&quot;Enter invoice amount:&quot;</span>)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Find sheet</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> 39</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>Worksheets(i).Name = accNumber <span class="kw">Then</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>        startPaste = Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 1).Value = <span class="dt">Date</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 2).Value = <span class="st">&quot;Invoice&quot;</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 3).Value = invoiceAmount</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 4).Value = Worksheets(i).Cells(startPaste - 1, 4).Value + Worksheets(i).Cells(startPaste, 3).Value</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>        MsgBox <span class="st">&quot;Invoice succesfully added&quot;</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Activate</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
<p>Payment button:</p>
<div class="sourceCode" id="cb80"><pre
class="sourceCode vb"><code class="sourceCode monobasic"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> accNumber <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> paymentAmount <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> startPaste <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="kw">Dim</span> i <span class="kw">As</span> <span class="dt">Integer</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Enter account number</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>accNumber = InputBox(<span class="st">&quot;Enter account number:&quot;</span>)</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Enter payment amount</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>paymentAmount = InputBox(<span class="st">&quot;Enter payment amount: (positive)&quot;</span>)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co">&#39;Find sheet</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="kw">For </span>i = 2 <span class="kw">To</span> 39</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">If </span>Worksheets(i).Name = accNumber <span class="kw">Then</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>        startPaste = Worksheets(i).Cells(Rows.Count, 1).End(xlUp).Row + 1</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 1).Value = <span class="dt">Date</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 2).Value = <span class="st">&quot;Payment&quot;</span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 3).Value = paymentAmount * -1</span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Cells(startPaste, 4).Value = Worksheets(i).Cells(startPaste - 1, 4).Value + Worksheets(i).Cells(startPaste, 3).Value</span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>        MsgBox <span class="st">&quot;Payment succesfully added&quot;</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>        Worksheets(i).Activate</span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">End If</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a><span class="kw">Next </span>i</span></code></pre></div>
</div>
<div id="chapter-9" class="section level3">
<h3><u>Chapter 9</u></h3>
<p>Solution already provided in the workbook</p>
</div>
<div id="chapter-10" class="section level3">
<h3><u>Chapter 10</u></h3>
<p>Solution already provided in the workbook</p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
